МИНОБРНАУКИ РОССИИ
Федеральное государственное бюджетное 
образовательное учреждение высшего образования
«Челябинский государственный университет» 
(ФГБОУ ВО «ЧелГУ»)

Институт информационных технологий

Кафедра информационных технологий и экономической информатики





КУРСОВАЯ РАБОТА

по дисциплине «Проектирование и разработка распределенных программных систем»

«Разработка веб-сайта для поиска исполнителей на Django»
(тема)



Выполнил студент Вдовенко Александр Сергеевич
					(Ф.И.О.)
Группы ПрИЗ-301
заочной формы обучения 
направления подготовки 
программная инженерия____________________________________
                             (подпись)
«__27__» ____сентября________ 2025__г.
















Челябинск
2025



Научный руководитель
Фамилия, имя, отчество_________________
Должность____________________________
Ученая степень ________________________
Ученое звание _________________________
______________________________________
                           (подпись)
«___» _________ 20____г.






Задание на курсовую работу

Реализовать проект: pазработка веб-сайта для поиска исполнителей на Django.
В ходе реализации проекта необходимо:
1. Выполнить бизнес-анализ предметной области, включая:
1.1. Интервьюирование заказчика и конечных пользователей
1.2. Описание заинтересованных лиц и конечных пользователей
1.3. Анализ бизнес-требований (в виде схемы бизнес-целей, бизнес-требований и функций системы)
1.4. Анализ основных сценариев использования
2. Провести сравнительный анализ существующих аналогичных решений на рынке
3. Разработать концепцию решения, включая:
3.1. Описание общей функциональности решения
3.2. Детализация требований к решению (описание пользовательских историй с учетом приоритетов и декомпозиции на подзадачи по методике User Story Mapping)
3.3. Описание границ решения
3.4. Описание возможных архитектурных и технических решений
4. Спроектировать разрабатываемую систему, включая:
4.1. Проектирование архитектуры/структуры системы
4.2. Проектирование базы данных
4.3. Прототипирование интерфейса пользователя
4.4. Детальное проектирование отдельных модулей (при необходимости детализации)
5. Выполнить программную реализацию первой версии системы (продукта)
6. Выполнить функциональное тестирование системы по тестовым сценариям
Содержание

1	Бизнес-анализ	4
1.1	Интервьюирование заказчика  и пользователей	5
1.2	Описание текущей ситуации (как было)	8
1.3	Описание будущей ситуации (как будет)	10
1.4	Описание заинтересованных лиц и конечных пользователей	10
1.5	Бизнес-требования	11
2	Анализ существующих решений	12
2.1	Обзор существующих решений	12
2.2	Сравнительный анализ решений	13
2.3	Выводы по анализу	13
3	Концепция решения	14
3.1	Техническое задание	14
3.1.1	Общие сведения	18
3.1.2	Назначение и цели создания системы	18
3.1.3	Требования к системе	18
3.1.4	Состав и содержание работ по созданию системы	22
3.1.5	Порядок контроля и приемки системы	24
3.2	Модель прецедентов	24
3.2.1	Акторы	24
3.2.2	Диаграмма прецедентов	25
3.2.3	Сценарии использования	26
3.3	Customer Journey Mapping	44
3.4	Пользовательские истории – User Story Mapping	45
3.5	Анализ факторов риска проекта	46
4	Проектирование решения	47
4.1	Описание архитектуры/структуры системы	47
4.2	Описание возможных технических решений	47
4.3	Проектирование интерфейса пользователя	49
4.4	Проектирование базы данных	65
5	Программная реализация системы	76
6	Функциональное тестирование решения	138
Список литературы	180
















1 Бизнес-анализ
      В современном мире интернет принимает все большее значение. Все больше людей хотят получать услуги онлайн. Также, все больше людей хотят получать индивидуальные товары. При этом всем активно развивается хенд-мейд сообщество.
* Особенностями хенд-мейд работ являются:
* Индивидуальность
* Гибкость при заказе
* Для выполнения заказов используются:
* Пряжа/спицы
* Фурнитура
* Ткани
* Выкройки 
* Заказчиками на данные виды работ являются 
* Люди, которые хотят получить индивидуальный продукт
      Бизнес целью является создание платформы для обмена информацией о заказах товаров ручной работы между заказчиками и исполнителями. Исходя из этого, бизнес-требованиями стали:
* Разделение пользователей на заказчиков и исполнителей
* Разделение заказов по категориям
* Информация о заказе, возможность добавлять иллюстрации для более подробной информации
* Возможность исполнителям опубликовывать портфолио
* Возможность исполнителям откликаться на заказы
* Возможность обмениваться сообщениями между пользователями























1.1 Интервьюирование заказчика и пользователей
 Выразим гипотезы:
 Гипотеза 1:
Предположение: люди хотят размещать заказы на предметы ручной работы на веб-сайте.

      Гипотеза 2:
Предположение: мастера-производители предметов ручной работы хотят продавать свои изделия

      На рис. 1 представлена таблица систематизации данных с проблемного интервью.








Человек, портрет2 гипотезыПервый блок вопросовВторой блок вопросовТретий блок вопросовВыводы о том, подтвердилась ли проблема?Ситуация, когда проблема возникает?Анна, вязальщица, Челябинскмастера-производители предметов ручной работы хотят продавать свои изделия?
1) где вы работаете? Какая профессия?
2) у вас есть хобби? Какое?
2.5) сколько денег в год вы тратите на хобби?
3) вы когда-нибудь создавали предметы своими руками? Какими они были?
4) какие предметы вы бы хотели создать своими руками?
5) вы когда-нибудь продавали предметы, созданные своими руками? Хотите ли вы их продавать? 
1) какие сложности вы испытываете при продаже своих изделий?
2) что вы сделали чтобы преодолеть эти сложности?




1) Почему вы решили продавать свои изделия?
2) сколько изделий вы можете изготовить и продать за месяц?

ДаКогда нужно продавать продукциюЕлена, продавец,подрабатывает швеей, ЧелябинскДаКогда нужно искать заказчиковМарина, провизор,подрабатывает ювелиром,МоскваДаКогда нужно искать заказчиков/когда нужно продавать продукциюПетр, делает ножи на заказ, МоскваДаКогда нужно искать заказчиков/когда нужно продавать продукциюИван, маркетолог, Москва


люди хотят размещать заказы на предметы ручной работы на веб-сайте?
1) где вы работаете? Какая профессия?
2) вы когда-нибудь покупали (получали в подарок) предметы ручной работы?
2.5) сколько они стоили?
3) к какой категории относились предметы ручной работы, которыми вы владели? Что это были за предметы?
4) вы бы предпочли предмет ручной работы товару промышленного производства, вне зависимости от категории? 
1) как вы выбирали предмет ручной работы, который купили в прошлый раз?
2) где и как вы его купили?
3) какие сложности в связи с этим возникли?
1) почему вы выбрали предмет именно ручной работы?
2) почему именно в этой категории?
3) хотели бы вы приобретать больше предметов ручной работы? Из каких категорий?
НетНе возникалоАлена, кассир, Москва


ДаНедостаточно предложений на существующих веб-сайтахМария, финансовый консультант, Москва


ДаНет подходящих веб-сайтовКатерина, фитнес-тренер, Челябинск


ДаТрудности с поиском исполнителей 
Рис. 1 Таблица систематизации данных с проблемного интерью
      На рис. 2 представлена таблица принятия решений.

ГипотезаМетрика для принятия решенияРезультат исследованияВывод1. Люди хотят размещать заказы на предметы ручной работы на веб-сайте.больше 50% опрошенных выразят предпочтение товарам ручной работы
55 % опрошенных предпочитают продукт, сделанный под индивидульные требованияРазработка пилотного веб-сайта2. Мастера-производители предметов ручной работы хотят продавать свои изделия
больше 70% опрошенных выразят желание зарабатывать своим творчеством
80 % опрошенных предпочитают хотели бы расширить свои продажиРазработка пилотного веб-сайта
Рис. 2 Таблица принятия решения



1.2 Описание текущей ситуации (как было)


     На данный момент существует несколько сайтов с подобным функционалом. Некоторые из подобных веб-сайтов имеют обратный функционал: исполнитель создает портфолио с существующими работами и таким образом принимает заказы. Другие сайты не пересекаются с тематикой проектируемого веб-сайта и имеют свои недостатки, о которых будет прописано в сравнительном анализе.
       Сайт должен быть простым и понятным, иметь возможность регистрации, просмотра профиля, редактирования профиля, создания заказа и откликов на него, а также обмена сообщениями заказчик-исполнитель. 
      На рис. 3 представлена текущая ситуация  ввиде диаграммы последовательности с точки зрения заказчика, а на рис. 4 –с точки зрения исполнителя.Так же проблемы выявлены и представлены в нижеследующих таблицах.
      
      
      
      
      Рис. 3 Диаграмма последовательности с точки зрения заказчика.
      
      
      
      
      
      
      Рис. 4 Диаграмма последовательности с точки зрения исполнителя.
      
      
Проблема 1Отсутствие узко-специализированного веб-сайтаВоздействует наЗаказчиков, исполнителей, рынокРезультатом чего являетсяНеудовлетворенный спросСейчас решаетсяinstagram, vk, индивидуальные веб-сайты, веб-сайты с похожей тематикойИмеющиеся решения неНе охватывают всю целевую аудиторию
Проблема 2Поиск потенциальных исполнителейВоздействует наЗаказчика /исполнителяРезультатом чего являетсяПотеря времени. Неполный охват потенциальных исполнителей. Отсутствие адекватного сравнения между исполнителямиСейчас решаетсяПоиском в поисковых индексаторах, веб-сайты с похожей тематикойИмеющиеся решения неПовышают выбор заказчика

Проблема 3Поиск потенциальных заказчиковВоздействует наЗаказчика /исполнителяРезультатом чего являетсяПотеря дохода. Многие исполнители готовы работать на индивидуального заказчикаСейчас решаетсяСоздание своих страниц в instagram, групп с социальных сетях, самореклама в соц. сетях, создание собственных сайтов, веб-сайты с похожей тематикойИмеющиеся решения неПовышают выбор количество заказов для исполнителей,


1.3 Описание будущей ситуации (как будет)
Итогом первой реализации проекта должен быть веб-сайт с такими возможностями:
* Регистрация пользователей в качестве исполнителя, либо заказчика
* Возможность заказчикам создавать заказы в определенной рубрике
* Возможность исполнителям создавать портфолио 
* Возможность исполнителям откликаться на заказы
* Возможность заказчикам просматривать отклики на заказы
* Возможность переписки между заказчиками и исполнителями
* Возможность комментировать заказы

1.4 Описание заинтересованных лиц и конечных пользователей





ПредставительПотенциальный заказчикОписаниеДевушка, которая хочет вязаный свитер из определенной шерсти с определенным узоромТипСлучайный пользователь: потенциальный заказчикОтветственностьИнтерес проявляется в возможности разместить объявление и найти потенциальных исполнителейКритерий успехаУспехом представляется получение готового продукта в соответствии с ожиданиямиВовлеченностьТестирование программного продуктаПоставляемые артефактыОписание заказа, прикрепление изображенийКомментарии / ПроблемыСложность в поисках потенциального исполнителя заказа

ПредставительПотенциальный исполнительОписаниеДевушка, которая умеет вязать вещи ТипСлучайный пользователь: потенциальный исполнительОтветственностьИнтерес проявляется в возможности разместить портфолио, просматривать заказа и откликаться на те, которые под силу выполнить. Критерий успехаУспехом представляется получение вознаграждения за готовый продукт.ВовлеченностьТестирование программного продуктаПоставляемые артефактыПрикрепление изображений выполненных работ в портфолиоКомментарии / ПроблемыСложность в поисках потенциальных заказов, которые соответствуют квалификации
1.5 Бизнес-требования
     Для получения бизнес целей необходимо выполнить определенные бизнес-требования.
     На рис. 5 представлен наглядный пример связи этих процессов в виде Impact Mapping.



     Рис. 5 Impact Mapping.


2. Анализ существующих решений
2.1 Обзор существующих решений
Решение 1. «Ярмарка мастеров»
https://www.livemaster.ru/
Сайт с возможностью купить уже готовые хенд-мейд вещи у исполнителя. Цвета, размеры, и прочие параметры определяет исполнитель, а не заказчик. Заказчик может только купить работу в осуществленных исполнителем параметрах.
Решение 2. «youdo»
https://youdo.com/
Сайт с возможностью заказать услугу, а также стать исполнителем этой услуги. Заказчик может предложить задание исполнителю


2.2 Сравнительный анализ решений

Критерии сравненияЯрмарка мастеровyoudoКаталог заказов на хенд-мейд продукции
нетнетВозможность создавать заказ с описаниемнетестьВозможность прикреплять изображения к заказуестьестьВозможность писать сообщения
естьограниченыВозможность откликаться на заказы нетестьРазделение на категории пользователей 
нетнетКомментарии к заказунетнетОтзывы о заказчикенетестьОтзывы о исполнителеестьесть
2.3 Выводы по анализу

После проведенного анализа можно сделать выводы:
* Каталога с заказами на хенд-мейд продукцию нет ни в одном варианте
* На решении номер 1 невозможно создать заказ со своими требованиями
* В обоих решениях есть возможность прикреплять портфолио исполнителей
* Возможности писать сообщения ограничены на решении номер 2
* В обоих решениях нет разделения на пользователей
* В обоих решениях нет возможности оставить комментарии к заказу для уточнения деталей
* В обоих решениях есть отзывы об исполнителях
* В решении номер 2 есть возможность откликнуться на заказ

3 Концепция решения
3.1 Техническое задание
1. Общие слова, используемые в проекте
Заказчик-человек, который хочет получить индивидуальный продукт. Для этого регистрируется в системе и создает заказ.
Исполнитель-человек, который может выполнить индивидуальный заказ. Для этого регистрируется в системе и откликается на заказы.
Заказ-вид объявления, который содержит характеристику того, что заказчик хочет получить в итоге.
Профиль-страница каждого зарегистрированного пользователя с личной информацией.
Отклик-возможность исполнителю предложить свои услуги: выполнить определенный заказ.
Надрубрика-обобщенное название рубрики. Например, вязание, шитье.
Подрубрика-подтип рубрики. Разделение надрубрики на более конкретные объявления.
главное меню-меню, которое состоит из полей: главная, все исполнители, надрубрики-подрубрики
меню профиля-меню, которое появляется после регистрации/входа пользователя в систему. В зависимости от прав доступа меняется и состав меню. Общими полями для всех зарегистрированных являются: мой профиль, мои сообщения, выход, удалить профиль. Для заказчиков дополнительное поле: мои заказы.
2. Эксплуатационное назначение: состыковка потенциальных заказчиков и клиентов
3. Функциональное назначение: каталог заказов, поиск по заказам, регистрация пользователей, обмен сообщениями, возможность просматривать профили исполнителей, возможность откликаться на заказы, возможность создавать заказы
4. Данные и списки.
Данные-перечень сущностей с полями:
Сущность Надрубрика
Поля:
Название 
Порядок 

Сущность Подрубрика
Поля:
Название
Порядок

Сущность Заказ
Поля:
Автор
Название
Описание
Изображение
Активность
Дата публикации

  Сущность Изображения к заказу:
Поля:
Заказ
Изображение


Сущность: Пользователь
Поля:
Роль: Заказчик
Роль: Исполнитель

Сущность: Заказчик
Поля: 
Имя пользователя
Пароль
Имя
Фамилия
Аватар
Телефон
Город

Сущность Исполнитель:
Поля: 
Имя пользователя
Пароль
Имя
Фамилия
Аватар
Телефон
Город
Интересы
Рубрика
Портфолио

Сущность Комментарии
Поля:
Автор
Текст
Дата
Активность

Сущность Сообщение
Поля:
Чат
Автор
Текст сообщения
Дата написания
Статус (прочитано или нет)

Страницы с описанием:

1. Главная.
Доступна: всем пользователям.
Наполнение: приглашение к регистрации, общая информация о веб-сайте, главное меню с надрубриками-подрубрикам, меню входа для авторизованных пользователей.

2. Все исполнители:
Доступна: только авторизованным пользователям
Наполнение: отображается список всех исполнителей, фильтр по городам, кнопка “Искать”.

3. Страница Отображения каждого исполнителя
Доступна: только авторизованным пользователям
Наполнение: главное меню, меню профиля, форма см. стр. профиль пользователя: исполнитель, кнопка “Написать сообщение”.

3. Надрубрика-подрубрика.
Доступна: всем пользователям
Наполнение: главное меню, отображение списка заказов в соответствие с выбранной категорией, форма поиска, пагинация.

4. Страница детального отображения заказа в надрубрике-подрубрике:
Доступна: информация отображается в соответствии с правами доступа.
Для гостей: главное меню, поля: название заказа, описание, прикрепленные изображения, имя заказчика, дата создания, город. 
Для заказчиков: главное меню, название заказа, описание, прикрепленные изображения, имя заказчика, дата создания, город, возможность оставлять комментарий к заказу.
Для исполнителей: главное меню, название заказа, описание, прикрепленные изображения, имя заказчика, дата создания, город, возможность откликнуться на заказа, возможность написать сообщение автору заказа, возможность оставлять комментарий к заказу.

4. Страница входа
Доступна: всем пользователям.
Наполнение: главное меню, форма ввода имени пользователя и пароля, кнопка входа.

5. Страница регистрации.
Доступна: всем пользователям.
Наполнение для разных групп пользователей:
Для регистрации в качестве заказчика: форма с полями: имя пользователя, пароль, подтверждение пароля, выбор города из списка.
Для регистрации в качестве исполнителя: форма с полями: имя пользователя, пароль, подтверждение пароля, указание интересов, выбор города из списка.
Наполнение для всех видов пользователей: главное меню, кнопка Зарегистрироваться.

6. Страница Мой профиль
Доступна: только авторизованным пользователям
Наполнение для всех видов пользователей: главное меню, меню профиля, форма в виде визитки: справа: поля: полное имя, телефон, город, кнопки изменить личные данные, изменить пароль, слева: отображение аватара.
Наполнение для профиля заказчика: см. наполнение для всех видов пользователей
Наполнение для профиля исполнителя: добавленные поля: интересы, рубрика, портфолио(изображение)

8. Страница Изменить личные данные:
Доступна: только авторизованным пользователям
Наполнение для всех видов пользователей: главное меню, меню профиля, имя, фамилия, город, аватар, кнопка “Редактировать”
Наполнение для заказчиков: см. наполнение для всех видов пользователей.
Наполнение для исполнителей: дополнительные поля: интересы, рубрика, портфолио (изображение).

8. Страница Изменить пароль:	
Доступна: только авторизованным пользователям
Наполнение: поля: главное меню, меню профиля, старый пароль, новый пароль, подтверждение нового пароля, кнопка “Изменить”

9. Страница Мои сообщения:
Доступна: только авторизованным пользователям
Наполнение: главное меню, меню профиля, отображение аватара, вывод списка диалогов (ссылочный тип).

10. Страница Мои сообщения-детальное отображение:
Доступна: только авторизованным пользователям
Наполнение: главное меню, меню профиля, отображение аватара, вывод всех сообщений из выбранного диалога, форма ввода текста, кнопка “Отправить”.

11. Страница Выход:
Доступна: только авторизованным пользователям
Наполнение: отсутствует. При нажатии на ссылку Выход пользователь переходит на страницу выход с текстом оповещения о выходе.

12. Страница Удалить профиль:
Доступна: только авторизованным пользователям
Наполнение: текстовое оповещение о выходе пользователя, кнопка “Удалить”.

13. Страница Мои объявления:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, список из опубликованных объявлений с полями: название, дата создания, отклики, действия, кнопка “Добавить объявление”
Поле действия: 2 кнопки: “Редактировать” и “Удалить”

14. Страница Добавить объявление:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, форма добавления объявления (см. данные), кнопка “Добавить”

15. Страница Редактировать объявление:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, форма редактирования объявления (см. данные), кнопка “Редактировать”.

16. Страница Удалить объявление:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, название объявления, кнопка “Удалить”.

17. Страница Отклики:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, вывод списка всех заказов с откликами с полями: имя, название заказа, дата отклика, детали (ссылочный тип: при переходе просматривается профиль откликнувшегося исполнителя)

19. Страница Профиля откликнувшегося:
Доступна: только заказчикам
Наполнение: главное меню, меню профиля, форма см. стр. Профиль пользователя: исполнитель, кнопка “Написать сообщение”

20. Страница Написать сообщение:
Доступна: заказчикам/исполнителям
Наполнение: главное меню, меню профиля, отображение аватара, вывод сообщений, форма ввода текста, кнопка “Отправить”.
Всё, что не оговорено, выполняется на усмотрение исполнителя


3.1.1 Общие сведения

1.Реализовать проект: разработка веб-сайта для поиска исполнителей на Django.
2. Отсутствуют
3.1.01.2021-28.03.2021
4.Отсутствуют

3.1.2 Назначение и цели создания системы

Назначение системы:
* Проектирование веб-сайта для поиска исполнителей на Django
 
Цели создания системы
* Веб-сайт с возможностью регистрации и создании заказов и поиска исполнителей

Техническая часть, включающая:
* интерфейс пользователей с разделением на категории: заказчик/исполнитель
* административная часть


Производственно-экономические показатели:
* количество уникальных посетителей

3.1.3 Требования к системе

3.1.3.1 Требования к структуре и функционированию системы
      Система должна:
      1. Предоставлять информацию о сайте (высокий приоритет)
      1.Предоставлять возможность регистрации пользователей с разделением на 2 категории: заказчик и исполнитель (высокий приоритет). 
      Предоставлять информацию о пользователях в панель администратора (высокий приоритет)
      2. Предоставлять возможность заказчику опубликовывать заказы (высокий приоритет)
      3. Предоставлять каталог заказов (высокий приоритет)
      4. Предоставлять подробную информацию о заказе (высокий приоритет).
      6. Предоставлять возможность оставлять комментарии к заказу (средний приоритет)
      Предоставлять информацию комментариев в панель администратора (средний приоритет)
1. Предоставлять возможность исполнителю написать автору заказа (высокий приоритет)
2. Предоставлять информацию о сообщениях в панель администратора (высокий приоритет)
      7. Предоставлять информацию о всех исполнителях (высокий приоритет)
      8. Предоставлять возможность исполнителю опубликовывать портфолио (высокий приоритет)
      9. Предоставлять возможность исполнителю откликаться на заказы (высокий приоритет)
      10. Предоставлять возможность заказчику просматривать отклики на заказ (высокий приоритет)
      11. Предоставлять возможность заказчику просматривать подробный профиль откликнувщегося (высокий приоритет)
      Предоставлять информацию об откликнувшихся в панель администратора (высокий приоритет)
      12. Предоставлять возможность заказчику написать сообщение откликнувщемуся (высокий приоритет)
      13. Выполнять поиск по заказам (высокий приоритет)
      Выполнять фильтрацию исполнителей по городам (низкий приоритет)
      

   В перспективах развития: 
* добавление рейтинга
* добавление отзывов об исполнителях
* добавление фильтров по различным категориям
* добавление исполнителям возможность загружать много изображений
* добавление уведомления о новом отклике
* добавление уведомления о новом комментарии
* добавление уведомления о новом сообщении
* возможность прикреплять к сообщению изображение
* возможность восстановления пароля через почту


 	Классы пользователей:
1) Гость- неавторизованный пользователь
2) Заказчик – авторизованный пользователь, обладает правами: 
Статические разделы – просмотр: Главная страница, Заказы + детальный просмотр заказа, 
Динамические: 
Раздел Все исполнители: возможность написать любому исполнителю личное сообщение
Раздел Мои объявления: Добавление, правка, удаление объявления. Отображение заказа и откликов на него. Возможность просматривать портфолио откликнувшихся и писать им личные сообщения.
Раздел Мой профиль: просмотр профиля, редактирование личных данных, редактирование пароля
Раздел Выход: выход из системы
Раздел Удаление пользователя: полное удаление пользователя без возможности восстановления
3) Исполнитель – авторизованный пользователь, обладает правами: 
Статические разделы – просмотр: Главная страница, Все исполнители
Динамические: 
Раздел Заказы + детальное отображение заказа: возможность откликнуться на заказ, возможность написать сообщение автору объявления.
Раздел Мой профиль: просмотр профиля, редактирование личных данных, редактирование пароля
Раздел Выход: выход из системы
раздел Удаление пользователя: полное удаление пользователя без возможности восстановления

4) Администратор, обладает правами: полный доступ ко всем функциональным возможностям администрирования системы;
3.1.3.2 Требования к характеристикам взаимосвязей со смежными системами – описание границ решения
Смежные системы в проекте не предусмотрены

3.1.3.3 Требования к численности и квалификации пользователей
Пользователей АС можно разделить на 4 части:
Гости:
уверенные пользователи сети интернет
режим работы пользователей неограничен

Заказчики:
уверенные пользователи сети интернет
режим работы пользователей неограничен

Исполнители:
уверенные пользователи сети интернет
режим работы пользователей неограничен

Администратор:
требуется понимание работы панели администратора


3.1.3.4 Требования к дизайну и реализации
Требования к дизайну:
При разработке сайта должны быть использованы преимущественно светлые и контрастные цветовые решения. Оформление должно быть разработано в достаточно консервативном ключе. Основные разделы сайта должны быть доступны с первой страницы.
Требования к реализации и ограничения:
* инструмент быстрой разработки Django 3.1.4 (Python 3.8)
* БД по умолчанию SQLite
* кроссплатформенность
* инструмент для оформления Bootstrap 4
* Jquery 3.

      Среда разработки-PyCharm 3.1

Ограничения:
* сроки реализации:1.01.2021- 28.03.2021
* Любой из перечисленный ниже браузеров (указана минимальная версия) с включенным интерпретатором JavaScript: 
Internet Explorer 6, Mozilla 1.6 (Firefox 1.0),  Opera 9

3.1.3.5 Требования к операционной среде (системе)
Операционная система: кроссплатформенность
      Веб-приложения Django можно запускать почти на любых машинах, которые поддерживают язык программирования Python 3.0, среди  прочих: Windows, Mac OS X, Linux/Unix, Solaris. Почти любой компьютер имеет необходимую производительность для запуска Django во время разработки.
      Стеки протоколов:  HTTP 
3.1.3.6 Требования к производительности
      Работа любого скрипта не должна превышать 60 секунд. 
3.1.3.7 Требования к защите информации, безопасности и сохранности данных
      
      Возможности Django с точки зрения безопасности:
* Защита от межсайтового скриптинга (XSS)
* Защита от подделки межсайтового запроса (CSRF)
* Защита от внедрения SQL
* Защита от скликивания
* SSL/HTTPS
* Проверка заголовка хоста
* Безопасность сессий
Код приложения должен находиться вне корня веб сервера. Django не ограничивает количество запросов при аутентификации пользователей. Для того, чтобы защититься от перебора логина/пароля, нужно поставить дополнительное приложение для Django или модуль для веб-сервера, чтобы ограничивать такие запросы.
Хранить содержимое параметра SECRET_KEY в секрете.
Хорошей идеей будет ограничить доступ к вашей системе кэширования и к базе данных с помощью фаервола.
При потере питания в системе, аварий, данные не будут потеряны.

3.1.3.8 Требования к внешнему интерфейсу
Требования к хранению данных:
      Все данные сайта должны храниться в структурированном виде под управлением реляционной СУБД. Наполнение различных сайтов, функционирование которых поддерживается одной и той же инсталляцией системы, должно храниться под управлением единой СУБД.
      Требования к языкам программирования:
Django 3.1.4 (Python 3.8) с БД SQLite
      Внешний интерфейс пользователя
Для реализации статических страниц и шаблонов должен использовался фреймворк Bootstrap 4.0, JQuery,Ajax, CSS

3.1.3.9 Требования к хостингу
Для работы сайта на Django подойдёт любой хостинг, соответствующим техническим требованиям:
* наличие определенного веб-сервера (Apache >= 2.2, Nginx 1.19.0);
* поддержка языка python 3.8;
* одна из множества систем управления баз данных, в том числе MySQL 5.5, PostgreSQL 9.4, Oracle 12.1.
   В данном проекте будет представлена локальная версия.
3.1.3.10 Требования к документации
Документация не разрабатывается
3.1.4 Состав и содержание работ по созданию системы


Перечень стадий и этапов работ
Сроки выполнения
Список исполнителей1. Определение бизнес целей10 дн.Исполнитель/Инициатор проекта
2. Сравнительный анализ существующих решений5 дн.Исполнитель
3. Выводы по результатам анализа существующих решений и бизнес требований и составление технического задания1 дн.ИсполнительСоздание веб-сайта72 дн.Все: Исполнитель3.1 Создание статических страниц : Главной и Базовой2 дн.3.2 Создание страниц для регистрации пользователей в качестве исполнителя или заказчика7 дн.3.3 Создание профилей заказчика и исполнителя7 дн.3.4 Создание возможности редактировать профиль/ изменять пароль для заказчика/исполнителя5 дн. 3.5 Создание возможности выходить из системы исполнителю/заказчику4 дн.3.6 Создание возможности удалять профиль заказчика/исполнителя4 дн.3.7 Создание раздела Надрубрики-Подрубрики2 дн.3.9 Создание раздела Мои объявления для заказчика с возможностью создания заказа в уже существующем каталоге Надрубрик-Подрубрик 2 дн.3.9 Дополнение раздела Мои объявления: возможность просматривать все свои объявления/редактировать/удалять7 дн.3.10 Дополнение раздела Мои объявления: возможность просматривать каждое свое объявление2 дн.3.11 Доработка раздела Надрубрика-Подрубрика: возможность просматривать все опубликованные заказы2 дн.3.12 Доработка раздела Надрубрика-Подрубрика: возможностью просматривать каждый опубликованный заказ2 дн.3.13 Создание возможности исполнителям откликаться на заказы7 дн.3.14 Дополнение раздела Мои объявления для заказчика: возможность просматривать отклики на объявления7 дн.3.15 Дополнение раздела Мои объявления для заказчика: возможность просматривать профиль откликнувшегося на заказ4 дн.3.16 Создание раздела Все исполнители с фильтрацией по городам4 дн.3.17 Создание системы сообщений между заказчиками и исполнителями. Внедрение возможности отправить сообщение в разделы: Все исполнители, Надрубрика-Подрубрика( в опубликованные заказы), в профили исполнителей, откликнувшихся на заказ4 дн.



3.1.5 Порядок контроля и приемки системы
      При приемке системы были проведены тестирования разделов. Проверялась корректность работы всех страниц, а также их взаимодействие с базой данных.
      Стадии: 
1. Проверка с помощью тестов
3.2 Модель прецедентов
3.2.1 Акторы


Наименование актораТип актораОписательная характеристикаГостьПервичный, инициирует регистрацию на сайте
Вторичный, просматривает страницы1. Инициирует регистрацию: переходит по ссылке регистрации
2. Посещает общедоступные страницы: ГлавнаяЗаказчикПервичный, инициирует регистрацию на сайте. Пользователь системы.1.Входит в систему
2.Посещает главную страницу
3. Посещает свой профиль(меняет личные данные/пароль)
4.Создает/редактирует/удаляет объявления
5.Просматривает отклики/профили откликнувщихся исполнителей.
6.Пишет/просматривает  сообщения
7.Просматривает всех исполнителей
7. Выходит из системы
Пишет комментарии к заказу
Просматривает свой заказ в общем доступе
Удаляет профиль
Исполнитель1.Инициирует вход в систему 
2. Вторичный1.1 Входит в систему
1.2 Посещает главную страницу
1.3 Посещает свой профиль(меняет личные данные/пароль
1.4 Просматривает заказы
1.5 Откликается на заказы
1.6 Пишет автору заказа
1.7 Пишет/просматривает сообщения.
1.7. Выходит из системы
Пишет комментарии к заказу
Удаляет профиль
2. Осуществляет исполнение заказа после отклика и согласования с заказчикомАдминистраторПервичный, инициирует сценарии в системе1. Заполняет раздел  Надрубрики-Подрубрики
2. Заполняет раздел Главная страница
2. Отслеживает действия пользователей
2. Отслеживает наполнение контента




3.2.2 Диаграмма прецедентов
На рис. 6 представлена диаграмма прецедентов, которая служит основой для разработки сценариев использования будущего веб-сайта.



Рис. 6 Диаграмма прецедентов
3.2.3 Сценарии использования

        Сценарии использования составлены в виде таблиц. События описаны с учетом цели пользователя, последовательности действий и результатом.

Сценарий 1. Посещение сайта гостем.

Описание[Краткое наименование сценария]Идентификатор прецедента1Список акторовГость/Заказчик/Исполнитель/АдминистраторПредусловияПри условии создания веб-сайта Действия пользователя Реакция системыПросмотр главной страницыОтображение главной страницыЗнакомство с общей информациейотсутствуетПостусловия1.Создание веб-сайта
2. Развертывание на хостингеВключениеОтсутствуютРасширениеОтсутствуютОбобщениеОтсутствуют

Сценарий 2. Просмотр страницы “Надрубрика-Подрубрика” заказчиком.
Описание[Краткое наименование сценария]Идентификатор прецедента23Список акторовЗаказчик/Исполнитель/Администратор/ГостьПредусловияПри созданном аккаунте
При наличии созданных заказовДействия пользователя Реакция системыНажатие на выбранную рубрику. Появление страницы со списком заказовПостусловияПри нажатии на выбранную рубрикуВключениеДетальное отображение заказаРасширениеОтсутствуют
Обобщение
Отсутствуют


Сценарий 3. Поиск по разделу Надрубрики-Подрубрики.

Описание[Краткое наименование сценария]Идентификатор прецедента3Список акторовГость/Заказчик/Исполнитель/АдминистраторПредусловияПоиск по заказам Действия пользователя Реакция системыНажатие на выбранную Надрубрику-ПодрубрикуВведение слова в строку поискаОтображение списка заказов, содержащее посиковое словоПостусловияВведение посикого слова в форму поискаВключениеДетальное отображение заказаРасширениеОтсутствуютОбобщениеОтсутствуют

Сценарий 4. Гость инициирует регистрацию в качестве заказчика

Описание[Краткое наименование сценария]Идентификатор прецедента4Список акторовГость/АдминистраторПредусловияПри желании зарегистироватьсяДействия пользователя Реакция системыПросмотр страницы Основная и переход по ссылке для регистрацииПереход на страницу регистрации как заказчикаЗаполнение формы регистрации и нажатие кнопки “ Зарегистрироваться”Переход на Главная 
Появление выпадающего меню профиляПостусловияКорректное заполнение формыВключениеОтсутствуютРасширениеОтсутствуютОбобщениеОтсутствуют
Сценарий 5. Гость инициирует регистрацию в качестве исполнителя

Описание[Краткое наименование сценария]Идентификатор прецедента5Список акторовГость/АдминистраторПредусловияПри желании зарегистрироватьсяДействия пользователя Реакция системыПросмотр страницы Основная и переход по ссылке для регистрацииПереход на страницу регистрации как исполнителяЗаполнение формы регистрации и нажатие кнопки “ Зарегистрироваться”Переход на Главная 
Появление выпадающего меню профиляПостусловияКорректное заполнение формы
ВключениеОтсутствуютРасширениеОтсутствуютОбобщение
Отсутствуют
Сценарий 6. Гость посещает страницу Надрубрика-Подрубрика

Описание[Краткое наименование сценария]Идентификатор прецедента6Список акторовГость/АдминистраторПредусловияПри посещения главной страницы сайта
Действия пользователя Реакция системыНажатие на выбранную рубрику. Появление страницы с заказамиПостусловияНажатии на выбранную рубрикуВключениеДетальная информация по каждому заказуРасширениеОтсутствуют
ОбобщениеОтсутствуют


Сценарий 7. Гость посещает страницу с детальной информацией по каждому заказу.

Описание[Краткое наименование сценария]Идентификатор прецедента7Список акторовГость/АдминистраторПредусловияПосещение страницы Надрубрика-Подрубрика
Действия пользователя Реакция системыНажатие на выбранную рубрику. Появление страницы с детальным отображением по каждому заказуПостусловияПри нажатии на выбранный заказВключениеОтсутствуют
РасширениеОтсутствуют
ОбобщениеОтсутствуют


Сценарий 8. Вход в профиль заказчика

Описание[Краткое наименование сценария]Идентификатор прецедента8Список акторовЗаказчик/Гость/АдминистраторПредусловияПри успешной регистрацииДействия пользователя Реакция системыВведение имя пользователя и пароля на странице “Вход”/или регистрация в качестве заказчика
Просмотр выпадающего меню профиля при нажатии ссылки “Профиль”Появление заказчика в БД.
Вход в профиль.
Появление страницы “Мой профиль”ПостусловияНажатие на кнопку ”Профиль”ВключениеМой профиль
Мои заказы
Мои сообщения
Выход 
Удалить профильРасширениеОтсутствуют

ОбобщениеОтсутствуют


Сценарий 9. Посещение страницы “Мой профиль” заказчиком

Описание[Краткое наименование сценария]Идентификатор прецедента9Список акторовЗаказчикПредусловияПри успешной регистрацииДействия пользователя Реакция системыНажатие на кнопку “Мой профиль” при раскрытии выпадающего меню “Профиль”Появление профиля пользователя с контактными данными, аватаромПостусловияНажатие на кнопку ”Мой профиль”ВключениеКнопка: Редактировать профиль
Кнопка: Изменить парольРасширениеОтсутствуют
Обобщение
Отсутствуют


Сценарий 10. Нажатие на кнопку “Изменить личные данные” заказчиком.

Описание[Краткое наименование сценария]Идентификатор прецедента10Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Изменить личные данные” Появление формы изменения личных данных заказчикаПостусловияЗаполнение всех разделов формы
Нажатие на кнопку: “Редактировать”
Внесение изменений в БД.
Возвращение на страницу “Мой профиль” с уже измененными даннымиВключениеОтсутствуютРасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 11. Нажатие на кнопку “Изменить пароль”

Описание[Краткое наименование сценария]Идентификатор прецедента12Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Изменить пароль” Появление формы изменения пароляПостусловияЗаполнение всех разделов формы
Нажатие на кнопку: “Изменить”
Сохранение нового пароля в БД.ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют



Сценарий 13. Посещение страницы “Мои заказы” заказчиком.

Описание[Краткое наименование сценария]Идентификатор прецедента13Список акторовЗаказчикПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на ссылку “Мои заказы”Появление страницы с выводом всех объявлений если они есть, а также с возможностью добавить объявление. Если их нет, возможность добавить объявление.ПостусловияНажатие на кнопку: “Мои заказы”
ВключениеДобавить заказ
Редактировать
Удалить
Отклики
Просмотр заказаРасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 14. Добавление заказа заказчиком.

Описание[Краткое наименование сценария]Идентификатор прецедента14Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Добавить заказ” Появление страницы с формой заказа.
Сохранение нового заказа в БД.ПостусловияКорретное заполнение всех разделов формы
ВключениеОтсутствуютРасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 15. Редактирование заказа заказчиком.

Описание[Краткое наименование сценария]Идентификатор прецедента15Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Редактировать” Появление страницы с формой для редактирования заказа.
Изменение в БД.ПостусловияКорректное заполнение всех разделов формы
Нажатие на кнопку:  “Редактировать”ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 16. Удаление заказа заказчиком.

Описание[Краткое наименование сценария]Идентификатор прецедента16Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Удалить” 
Подтверждение 

Нажатие на кнопку “Удалить”Появление страницы с название заказа и кнопкой:  “Удалить”

Удаление заказа из списка заказов
Удаление заказа из БДПостусловияНажатие на кнопку:  “Удалить”ВключениеСтраница подтверждения удаления заказаРасширениеОтсутствуют
Обобщение
Отсутствуют


Сценарий 17. Просмотр заказа заказчиком в списке заказов.

Описание[Краткое наименование сценария]Идентификатор прецедента17Список акторовЗаказчикПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на название заказа в списке заказов 
Появление страницы с детальными сведениями о заказе.ПостусловияПри созданных заказахВключениеОтсутствуют
РасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 18. Просмотр откликов, оставленных исполнителями, заказчиком.
Описание[Краткое наименование сценария]Идентификатор прецедента18Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При созданном заказе
При наличии отклика на заказДействия пользователя Реакция системыНажатие на кнопку откликаПоявление страницы с отображением имени пользователя исполнителя, датой отклика, названием заказаПостусловияНажатие исполнителем кнопки “Откликнуться”ВключениеПрофиль откликнувщегосяРасширениеОтсутствуют
ОбобщениеОтсутствуют
Сценарий 19. Просмотр профиля откликнувшегося.
Описание[Краткое наименование сценария]Идентификатор прецедента19Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При созданном заказе
При наличии отклика на заказДействия пользователя Реакция системыНажатие на ссылку “Просмотреть” на странице откликов Появление профиля откликнувшегося исполнителяПостусловияНажатие исполнителем кнопки “Откликнуться”ВключениеНаписать сообщениеРасширениеОтсутствуют
ОбобщениеОтсутствуют
Сценарий 20. Написание сообщения откликнувшемуся исполнителю.
Описание[Краткое наименование сценария]Идентификатор прецедента20Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При созданном заказе
При наличии отклика на заказДействия пользователя Реакция системыНажатие кнопку “Написать сообщение”

Ввести текст сообщения
Нажать кнопку “Отправить”Появление окна с возможностью написать текст и кнопкой “Отправить”

Отображение сообщения в ленте диалога.
Сохранение в БД.ПостусловияПри наличии отклика на заказВключениеОтсутствуютРасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 21. Посещение страницы Мои сообщения заказчиком.
Описание[Краткое наименование сценария]Идентификатор прецедента21Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При успешной регистрации
Действия пользователя Реакция системыНажатие на ссылку “Мои сообщения” Появление страницы с диалогамиПостусловияНажатие на ссылку “Мои сообщения”ВключениеДетальное отображение диалогаРасширениеОтсутствуют
ОбобщениеОтсутствуют
Сценарий 22. Просмотр выбранного диалога заказчиком
Описание[Краткое наименование сценария]Идентификатор прецедента22Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на выбранный диалог Появление ленты с сообщениями, текстовой формой, и кнопкой “Отправить”ПостусловияНажатие на выбранный диалогВключениеНаписать сообщениРасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 23. Написание сообщения заказчиком.
Описание[Краткое наименование сценария]Идентификатор прецедента23Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При выбранном диалоге
Действия пользователя Реакция системыВвод текста сообщения. Нажатие кнопки “Отправить”Появление сообщения в ленте сообщений.

Отображение сообщения в БДПостусловияВвод текста сообщения. Нажатие кнопки “Отправить”ВключениеОтсутствуютРасширениеОтсутствуют
ОбобщениеОтсутствуют
Сценарий 24. Выход из профиля заказчика.
Описание[Краткое наименование сценария]Идентификатор прецедента24Список акторовЗаказчикПредусловияПри созданном аккаунтеДействия пользователя Реакция системыНажатие на ссылку “Выйти” Выход из аккаунта. Появление страницы выхода.ПостусловияНажатие на ссылку “Выйти”ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 25. Удаление профиля заказчика.
Описание[Краткое наименование сценария]Идентификатор прецедента25Список акторовЗаказчик/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на ссылку “Удалить профиль”

 
Нажатие на кнопку “Удалить”
Появление страницы удаления с именем пользователя и кнопкой “Удалить”

Удаление заказчика и связанных с ним объектов из БД.ПостусловияНажатие на кнопку “Удалить”ВключениеОтсутствуют
РасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 26. Детальное отображение информации о выбранном заказчиком заказе в разделе Надрубрика-Подрубрика.
Описание[Краткое наименование сценария]Идентификатор прецедента26Список акторовЗаказчик/Исполнитель/АдминистраторПредусловияПри созданном аккаунте
При созданных заказахДействия пользователя Реакция системыНажатие на выбранный заказПоявление детальной информации по выбранному заказу.ПостусловияПри нажатии на выбранный заказВключениеНаписать комментарийРасширениеОтсутствуют
ОбобщениеОтсутствуют
Сценарий 27. Написание комментария заказчиком к заказу.
Описание[Краткое наименование сценария]Идентификатор прецедента27Список акторовЗаказчик/Исполнитель/АдминистраторПредусловияПри созданном аккаунте
При созданных заказахДействия пользователя Реакция системыЗаполнение формы комментария
Нажатие на кнопку “Отправить”Отображение комментария.
Сохранение комментария в БД.ПостусловияВключениеОтсутствуют
РасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 28. Посещение страницы “Все исполнители” заказчиком.
Описание[Краткое наименование сценария]Идентификатор прецедента28Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При наличии зарегистрирвоанных исполнителейДействия пользователя Реакция системыНажатие на ссылку “Все исполнители”Появление списка всех исполнителейПостусловияНажатие на ссылку “Все исполнители”ВключениеДетальное отображение исполнителяРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 29. Детальное отображение исполнителя при просмотре заказчиком
Описание[Краткое наименование сценария]Идентификатор прецедента29Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При выводе всех исполнителейДействия пользователя Реакция системыНажатие на имя любого исполнителя из общего списка исполнителейПоявление профиля исполнителя с кнопкой “Написать сообщение”ПостусловияНажатие на имя исполнителяВключениеНаписать сообщениеРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 30. Отправка сообщения заказчиком выбранному исполнителю
Описание[Краткое наименование сценария]Идентификатор прецедента30Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
При открытом детальном отображении профиля выбранного исполнителяДействия пользователя Реакция системыНажатие кнопку “Написать сообщение”

Ввести текст сообщения
Нажать кнопку “Отправить”Появление окна с возможностью написать текст и кнопкой “Отправить”

Отображение сообщения в ленте диалога.
Сохранение в БД.ПостусловияНажатие кнопки “Отправить”ВключениеОтсутствуютРасширениеОтсутствуют
ОбобщениеОтсутствуют

Сценарий 31. Вход в профиль исполнителя

Описание[Краткое наименование сценария]Идентификатор прецедента31Список акторовИсполнитель/Гость/АдминистраторПредусловияПри созданном аккаунтеДействия пользователя Реакция системыВведение имя пользователя и пароля на странице “Вход”/или регистрация в качестве исполнителя
Просмотр выпадающего меню профиля при нажатии ссылки “Профиль”Появление исполнителя в БД.
Вход в профиль.
Появление страницы “Мой профиль”ПостусловияНажатие на кнопку ”Профиль”ВключениеМой профиль
Мои сообщения
Выход 
Удалить профильРасширениеОтсутствуют

Обобщение
Отсутствуют

Сценарий 32. Посещение страницы “Мой профиль” заказчиком

Описание[Краткое наименование сценария]Идентификатор прецедента32Список акторовИсполнительПредусловияПри созданном аккаунте
При нажатии ссылки “Профиль”Действия пользователя Реакция системыНажатие на кнопку “Мой профиль” при раскрытии выпадающего меню “Профиль”Появление профиля пользователя с контактными данными, аватаромПостусловияНажатие на кнопку ”Мой профиль”ВключениеКнопка: Редактировать профиль
Кнопка: Изменить парольРасширениеОтсутствуют
Обобщение
Отсутствуют


Сценарий 33. Нажатие на кнопку “Изменить личные данные” исполнителем.

Описание[Краткое наименование сценария]Идентификатор прецедента33Список акторовИсполнитель/АдминистраторПредусловияПри созданном аккаунтеДействия пользователя Реакция системыНажатие на кнопку “Изменить личные данные” Появление формы изменения личных данных исполнителяПостусловияЗаполнение всех разделов формы
Нажатие на кнопку: “Редактировать”
Внесение изменений в БД.
Возвращение на страницу “Мой профиль” с уже измененными даннымиВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 34. Нажатие на кнопку “Изменить пароль”

Описание[Краткое наименование сценария]Идентификатор прецедента34Список акторовИсполнитель/АдминистраторПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на кнопку “Изменить пароль” Появление формы изменения пароляПостусловияЗаполнение всех разделов формы
Нажатие на кнопку: “Изменить”
Сохранение нового пароля в БД.ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 35. Посещение страницы Мои сообщения исполнителем.
Описание[Краткое наименование сценария]Идентификатор прецедента35Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на ссылку “Мои сообщения” Появление страницы с диалогамиПостусловияНажатие на ссылку “Мои сообщения”ВключениеДетальное отображение диалогаРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 36. Просмотр выбранного диалога исполнителем
Описание[Краткое наименование сценария]Идентификатор прецедента36Список акторовЗаказчик/Администратор/ИсполнительПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на выбранный диалог 

Ввод текста сообщения. Нажатие кнопки “Отправить”Появление ленты с сообщениями, текстовой формой, и кнопкой “Отправить”
Появление сообщения в ленте сообщений.
Отображение сообщения в БДПостусловияНажатие на выбранный диалогВключениеНаписать сообщениеРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 37. Выход из профиля исполнителя.
Описание[Краткое наименование сценария]Идентификатор прецедента37Список акторовИсполнительПредусловияПри созданном аккаунте
Действия пользователя Реакция системыНажатие на ссылку “Выйти” Выход из аккаунта. Появление страницы выхода.ПостусловияНажатие на ссылку “Выйти”ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 38. Удаление профиля исполнителя.
Описание[Краткое наименование сценария]Идентификатор прецедента38Список акторовИсполнитель/АдминистраторПредусловияПри созданном аккаунте
При нажатии ссылки “Профиль”
При нажатии ссылки “Удалить профиль”Действия пользователя Реакция системыНажатие на ссылку “Удалить профиль”

 
Нажатие на кнопку “Удалить”
Появление страницы удаления с именем пользователя и кнопкой “Удалить”

Удаление заказчика и связанных с ним объектов из БД.ПостусловияНажатие на кнопку “Удалить”ВключениеОтсутствуют
РасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 39. Детальное отображение информации о выбранном заказе в разделе Надрубрика-Подрубрика (исполнитель).
Описание[Краткое наименование сценария]Идентификатор прецедента39Список акторовЗаказчик/Исполнитель/АдминистраторПредусловияПри созданном аккаунте
При созданных заказахДействия пользователя Реакция системыНажатие на выбранный заказПоявление детальной информации по выбранному заказу.ПостусловияПри нажатии на выбранный заказВключениеНаписать комментарий
Написать автору заказа
ОткликнутьсяРасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 40. Написание комментария исполнителем к заказу.
Описание[Краткое наименование сценария]Идентификатор прецедента40Список акторовЗаказчик/Исполнитель/АдминистраторПредусловияПри созданном аккаунте
При созданных заказахДействия пользователя Реакция системыЗаполнение формы комментария
Нажатие на кнопку “Отправить”Отображение комментария.
Сохранение комментария в БД.ПостусловияВключениеОтсутствуют
РасширениеОтсутствуют
Обобщение
Отсутствуют

Сценарий 41. Оставление отклика на объявление
Описание[Краткое наименование сценария]Идентификатор прецедента41Список акторовИсполнитель/Администратор/ЗаказчикПредусловияПри созданном аккаунте
При просмотре заказаДействия пользователя Реакция системыНажатие на кнопку “Откликнуться”На кнопке появляется надпись “Уже откликнулись”
У заказчика, на чей заказ откликнулся исполнитель, в разделе “Мои заказы” появляется отклик в списке объявленийПостусловияНажатие исполнителем кнопки “Откликнуться”ВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют
Сценарий 42. Написать сообщение автору заказа
Описание[Краткое наименование сценария]Идентификатор прецедента42Список акторовИсполнитель/Администратор/ЗаказчикПредусловияПри созданном аккаунте
При просмотре заказаДействия пользователя Реакция системыНажатие на кнопку “Написать автору”

Ввод текста сообщения. Нажатие кнопки “Отправить”Появление ленты с сообщениями, текстовой формой, и кнопкой “Отправить”
Появление сообщения в ленте сообщений.
Появление сообщения у автора в сообщениях.
Отображение сообщения в БДПостусловияПосещение исполнителем заказа и желанием написать авторуВключениеОтсутствуютРасширениеОтсутствуют
Обобщение
Отсутствуют






























\














3.3 Customer Journey Mapping
   

     На рис. 7 представлена схема Customer Journey Mapping, которая описывает путь заказчика/исполнителя в рамках создаваемой системы.
     
     
Рис. 7 Customer Journey Mapping





3.4 Пользовательские истории – User Story Mapping

Поведение создаваемой системы описано с помощью карты User Story Map (рис. 8)



Рис. 8 User Story Mapping
3.5 Анализ факторов риска проекта
Факторы риска перечислены в нижеследующей таблице. Факторы риска отсортированы по мере убывания.


Тип (категория риска)РискПоследствияМеры по предотвращениюМеры по минимизации последствийВероятность свершения риска [P]Степень ущерба [L]Влияние (фактор риска)
[R] = [P] x [L]Коммерческий
(организационный)





Технический
(инструментальный)



Проектный
(технологический)Отсутствие заказов/отсутствие исполнителей




Отказ хостинга




Некорректно составленные веб-сайт
Отсутствие удовлетворенности заказчиков/отсутствие прибыли у исполнителей


Отсутствие 
Заказов/отсутствие исполнителей


Отсутствие заказов/исполнителейМаркетинг
Повышение качества исполнения товара
Оптимизация между стоимостью заказа и оплатой исполнителя

Выбор надежного хостинга



Максимальная проработка по результатам проблемного интервью/корректное
проектирование сайта
Снизить стоимость заказа/снизить стоимость исполнения
Запустить акции



Наличие постоянных заказчиков/исполнителей



Реклама в соцсетях/через друзей/знакомых3






2




210






8




530






16




10


4 Проектирование решения

4.1Описание архитектуры/структуры системы

Структура сайта — взаимосвязь всех его страниц с сохранением чёткой иерархии. На рис. 9 представлена структура сайта.



Рис. 9 Структура сайта

Основные особенности структуры сайта заключаются в следующем:
* На страницах присутствуют навигационная панель.
* Наибольшее количество страниц находятся на трех уровнях (для перехода к искомой странице требуется не более двух кликов от главной), есть 2 страницы с уровнем вложенности 5 и одна с уровнем 6.
* Со всех страниц есть ссылка на главную страницу сайта, на профиль зарегистрированного пользователя с выпадающим меню профиля, на основное меню.
* При увеличении или уменьшении количества Надрубрик и Подрубрик, количества пользователей, количества заказов, структура сайта остается прежней.


4.2 Описание возможных технических решений


      Django является чрезвычайно популярным и полнофункциональным, т.е. back-end и front-end   серверным веб-фреймворком, написанным на Python, использующий шаблон проектирования MVC
      Также, в отличие от других фреймворков, обработчики URL в Django конфигурируются явно при помощи регулярных выражений.
      Для работы с базой данных Django использует собственный ORM, в котором модель данных описывается классами Python, и по ней генерируется схема базы данных(SQLite)
Некоторые возможности Django:
* ORM, API доступа к БД с поддержкой транзакций
* встроенный интерфейс администратора, с уже имеющимися переводами на многие языки
* диспетчер URL на основе регулярных выражений
* расширяемая система шаблонов с тегами и наследованием
* система кеширования
* интернационализация
* подключаемая архитектура приложений, которые можно устанавливать на любые Django-сайты
* «generic views» — шаблоны функций контроллеров
* авторизация и аутентификация, подключение внешних модулей аутентификации: LDAP, OpenID и проч.
* система фильтров («middleware») для построения дополнительных обработчиков запросов, как например включённые в дистрибутив фильтры для кеширования, сжатия, нормализации URL и поддержки анонимных сессий
* библиотека для работы с формами (наследование, построение форм по существующей модели БД)
* встроенная автоматическая документация по тегам шаблонов и моделям данных, доступная через административное приложение

      В составе Django присутствует собственный веб-сервер для разработки. Сервер автоматически определяет изменения в файлах исходного кода проекта и перезапускается, что ускоряет процесс разработки на Python. Но при этом он работает в однопоточном режиме и пригоден только для процесса разработки и отладки приложения.

Для реализации использовались:

Django 3.1.4
Python 3.8
Bootstrap  4— свободный набор инструментов для создания сайтов и веб-приложений. Включает в себя HTML- и CSS-шаблоны оформления для типографики, веб-форм, кнопок, меток, блоков навигации и прочих компонентов веб-интерфейса, включая JavaScript-расширения.
JQuery-3
Среда разработки-PyCharm 3.1




4.3 Проектирование интерфейса пользователя


Рис. 10 Главная страница 




Рис. 11 Основное меню




Рис. 12 Страница регистрации исполнителя
 




Рис. 13 Страница регистрации заказчика




Рис. 14 Страниа входа для зарегистрированного пользователя




Рис. 15 Страница профиля заказчика







Рис. 16 Страница правки личных данных заказчика

Рис. 17 Страница смены пароля для всех видов пользователей


Рис. 18 Страница Мои заказы



Рис. 19 Страница Добавления заказа


Рис. 20 Страница Редактирования заказа




Рис. 21 Страница Удаления заказа



Рис. 22 Страница Всех откликов на заказ



Рис. 23 Страница Профиля откликнувшегося на заказ исполнителя


Рис. 24 Страница Выхода для всех пользователей


Рис. 25 Страница Удаления пользователя для всех пользователей


Рис. 26 Страница Всех исполнителей



Рис. 27 Детальная информация по выбранному исполнителю(исполнитель).


Рис. 28 Детальная информация по выбранному исполнителю(заказчик).




Рис. 29 Страница Надрубрика-Подрубрика для всех пользователей



Рис. 30 Страница Детального отображения заказа. Вид для гостей.



Рис. 31 Страница Детального отображения заказа. Вид из профиля заказчика.



Рис. 32 Страница Детального отображения заказа. Вид из профиля исполнителя.




Рис. 33 Страница Детального отображения заказа. Изменения после отклика исполнителя. Вид из профиля исполнителя.





Рис. 34 Страница Профиля исполнителя.


Рис. 35 Страница Изменения личных данных исполнителя.





Рис. 36 Страница Списка чатов для зарегестированных пользователей.









Рис. 37 Страница Списка сообщений для зарегистрированных пользователей.



4.4Проектирование базы данных


      На основании анализа сложились сущности: Пользователь, Заказчик, Исполнитель, Заказ, Изображения-к-заказу, Комментарии, Надрубрика, Подрубрика, Сообщения, Чат, а так же связи:
      -может быть заказчиком между сущностями пользователь - заказчик
      -может быть исполнителем между сущностями пользователь - исполнитель
      -может добавить между сущностями заказчик - заказ
      -может откликнуться между сущностями исполнитель – заказ
      -может иметь между сущностями заказ – изображения-к-заказу
      -есть подрубрика между сущностями заказ – подрубрика
      -есть надрубрика между сущностями надрубрика – подрубрика
      -может быть между сущностями заказ – комментарии
      -может написать между сущностями пользователь – комментарии
      -может написать между сущностями пользователь – сообщения
      -состоять между сущностями пользователь – чат
      -образуют между сущностями сообщения – чат
      База данных представлена в виде ER-диаграммы в нотации Питера-Чена (рис. 38)

            




Рис. 38 ER-диаграмма

      На основании анализа предметной области построим концептуальную модель, т. е. информационную модель наиболее высокого уровня абстракции.
      Она не привязана к определенной БД, это емкое формализованное описание, выраженное моделью “сущность-связь”. Ранее мы определили основные элементы данных. Для отображения использовалась программа CorelDraw.
      Сущность Пользователь образует с сущностями Заказчик, Исполнитель, Чат, Сообщение n-арную связь, которая будет описана ниже в виде отношений между двумя сущностями, т.е. бинарной.
      Сущность Заказ образует с сущностями Комментарий, Надрубрика, Исполнитель, Заказчик, Изображения-к-заказу n-арную связь, которая будет описана ниже ввиде отношений между двумя сущностями, т.е. бинарной.
      1. Рассмотрим вид связи может быть заказчиком между сущностями пользователь-заказчик. Связь между сущностями будет один-к-одному. Кардинальность связи 1,1 с обеих сторон сущностей.
      2. Рассмотрим вид связи может быть исполнителем между сущностями пользователь-исполнитель. Связь между сущностями будет один-к-одному. Кардинальность связи 1,1 с обеих сторон сущностей.
      3. Рассмотрим вид связи может добавить между сущностями заказчик-заказ. Так как у Заказчика может быть несколько заказов, а у Заказа только один заказчик, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Заказчик и 0,N-со стороны сущности Заказ.
      4. Рассмотрим вид связи может откликнуться между сущностями исполнитель-заказ. Связь имеет атрибуты. Так как у Заказа может быть несколько откликов исполнителей, и у Исполнителя может откликнуться на несколько заказов, связь между сущностями будет многие-ко-многим. Кардинальность 0, N с каждой стороны.
      5. Рассмотрим вид связи может иметь между сущностями заказ-изображения-к-заказу. Так как у Заказа может быть несколько Изображений, а Изображения должны принадлежать только одному Заказу, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Заказ и 0,N-со стороны сущности Изображение.
      6. Рассмотрим вид связи есть подрубрика между сущностями заказ-подрубрика. 
Так как Заказ может принадлежать только одной Подрубрике, а у Подрубрики может быть несколько Заказов, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Подрубрика и 0,N-со стороны сущности Заказ.
      7. Рассмотрим вид связи есть надрубрика между сущностями надрубрика-подрубрика. Связь может написать является бинарной связью между сущностями. Так как у Надрубрики может быть несколько Подрубрик, а у Подрубрики только одна Надрубрика, и она обязательна, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Надрубрика и 1,N-со стороны сущности Подрубрика.
      8. Рассмотрим вид связи может быть между сущностями заказ-комментарии. Так как у Заказа может быть несколько Комментариев, а у Комментария только один Заказ, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Заказа и 0,N-со стороны сущности Комментарий.
      9. Рассмотрим вид связи может написать между сущностями пользователь-комментарий. Так как у Пользователя может быть несколько Комментариев, а у Комментария только один автор, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Пользователь и 0,N-со стороны сущности Сообщение.
      10. Рассмотрим вид связи может написать между сущностями пользователь-сообщение. Так как у Пользователя может быть несколько Сообщений, а у Сообщения только один автор, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Заказчик и 0,N-со стороны сущности Сообщение.
      11. Рассмотрим вид связи состоять между сущностями пользователь-чат. 
Так как у Чата может быть несколько Пользователей, а у Пользователей несколько Чатов, то связь между будет многие-ко-многим. Кардинальность связи 0,N с обеих сторон сущностей.
      12. Рассмотрим вид связи образуют между сущностями сообщения-чат. Связь образуют является бинарной связью между сущностями.
      Так как у Чата может быть несколько Сообщений, а Сообщения принадлежат одному Чату, то связь между будет один-ко-многим. Кардинальность связи 1,1 со стороны сущности Чатк и 0,N-со стороны сущности Сообщение.
      Параметры, которые характеризовали элементы данных, будут являться атрибутами сущностей.
      Сущность Пользователь: атрибуты - Код пользователя, Роль: заказчик, Роль: исполнитель.
      Сущность Заказчик: атрибуты – Код заказчика (ключевой), Имя пользователя, Имя, Фамилия, Пароль, Город, Телефон, Аватар.
      Сущность Исполнитель: атрибуты – Код исполнителя (ключевой), Имя пользователя, Имя, Фамилия, Пароль, Город, Телефон, Аватар, Интересы, Портфолио.
      Сущность Заказ атрибуты – Код заказа (ключевой), Название, Описание, Автор, Дата публикации, Активность, Изображение
      Сущность Надрубрика атрибуты – Код надрубрики (ключевой), Название, Порядок
      Сущность Подрубрика атрибуты – Код подрубрики (ключевой), Название, Порядок
      Сущность Сообщение атрибуты – Код сообщения (ключевой), Автор,
Текст сообщения, Дата написания, Статус.
      Сущность Чат атрибуты – Код чата (ключевой), Тип, Участники.
      Сущность Изображения к заказу атрибуты – Код изображения (ключевой), Изображение
      Сущность Комментарии атрибуты – Код комментария (ключевой), Автор, Текст, Дата, Активность
      На рис. 39 отображена инфологическая модель разрабатываемой БД.



      Рис. Инфологическая модель разрабатываемой БД.

      При ее построении уточнялись детали каждой сущности:
      
      Сущность Пользователь - атрибуты:
Код_пользователя: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Роль: заказчик: Boolean, Mandatory (Обязательный)
Роль: клиент: Boolean, Mandatory (Обязательный)
      Сущность Заказчик - атрибуты:
Код_заказчика: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Имя пользователя: Variable characters(150), Mandatory(Обязательный)
Имя: Variable characters(20)
Фамилия: Variable characters(20)
Пароль: Variable characters(maxlength), Mandatory(Обязательный)
Город: Variable characters(30), Mandatory(Обязательный)
Телефон: Number
Аватар: Image

      Сущность Исполнитель - атрибуты: 
Код_исполнителя: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Имя пользователя: Variable characters(150), Mandatory(Обязательный)
Имя: Variable characters(20)
Фамилия: Variable characters(20)
Пароль: Variable characters(maxlength), Mandatory(Обязательный)
Город: Variable characters(30), Mandatory(Обязательный)
Рубрика: Variable characters(50), Mandatory(Обязательный)
Телефон: Number
Аватар: Image
Интересы: Variable characters(200), Mandatory(Обязательный)
Портфолио: Image

      Сущность Заказ - атрибуты: 
Код_заказа: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Название: Variable characters(40), Mandatory(Обязательный)
Описание: Text, Mandatory(Обязательный)
Автор: Variable characters(150), Mandatory(Обязательный)
Дата публикации: Data&Time, Mandatory(Обязательный)
Активность: Boolean, Mandatory(Обязательный)
Изображение: ImageField
Рубрика: Variable characters(150), Mandatory(Обязательный)
      Сущность Изображения к заказу - атрибуты: 
Код_изображения: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Изображение: ImageField, Mandatory(Обязательный)
      Сущность Надрубрика - атрибуты: 
Код_надрубрики: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Название: Variable characters(40), Mandatory(Обязательный)
Порядок: ShortInteger, Mandatory(Обязательный)

      Сущность Подрубрика - атрибуты: 
Код_подрубрики: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Название: Variable characters(40), Mandatory(Обязательный)
Порядок: ShortInteger, Mandatory(Обязательный)
      Сущность Комментарии - атрибуты: 
Код_подрубрики: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Автор: Variable characters(150), Mandatory(Обязательный)
Текст: Text, Mandatory(Обязательный)
Дата: Data&Time, Mandatory(Обязательный)
Активность: Boolean, Mandatory(Обязательный)
      Сущность Чат - атрибуты: 
Код_чата: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Тип: Variable characters(1)
Участники: Variable characters(150), Mandatory(Обязательный)

      Сущность Сообщение - атрибуты: 
Код_сообщения: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Чат:
Автор: Variable characters(150), Mandatory(Обязательный)
Текст сообщения: Text, Mandatory(Обязательный)
Дата написания: Data&Time, Mandatory(Обязательный)
      Связь может откликнуться –атрибуты:
Код_отклика: Первичный ключ (Primary Identifier), Serial, Mandatory (Обязательный)
Автор отклика: Variable characters(150), Mandatory(Обязательный)
Дата отклика: Data&Time, Mandatory(Обязательный)
      
Логическая модель БД  
      Даталогическое  проектирование выполняется под конкретную модель БД, в нашем случае под реляционную.
      Так как современные средства позволяют значительно упростить этапы проектирования, преобразуем инфологическую модель в даталогическую при помощи PowerDesigner в нотации IDEF1X (рис. 40). IDEF1X является методом для разработки реляционных баз данных и использует условный синтаксис, специально разработанный для удобного построения. По сравнению с другими многочисленными методами разработки реляционных баз данных, такими как ER,  является жесткая и строгая стандартизация. Установленные стандарты позволяют избежать различной трактовки построенной модели.
      В отношения, существующие между сущностями Пользователь-Заказчик и Пользователь-Исполнитель со стороны «один» Заказчик и «один» Исполнитель добавляется внешний ключ Пользователя. Так как эти сущности существуют независимо друг от друга, связь в виде внешнего ключа Код_пользователя добавлена в таблицы сущностей  Заказчик и Исполнитель.
      Связь между сущностями Исполнитель и Заказ становится новое отношение, т. к. между сущностями существует связь многие-ко-многим: может откликнуться. В этой связи внешними ключами будут Код_исполнителя и Код_заказа, совокупность которых будет являться первичным ключом.
      В отношение, соответствующее сущности со стороны «многие» (Комментарий-связь может быть)  Комментарий, добавляется первичный ключ со стороны сущности «один»: заказ. При этом первичный ключ Код_заказа в наборе атрибутов Комментарий становится внешним ключом.
      В отношение, соответствующее сущности со стороны «многие»(Заказ-связь есть подрубрика), добавляется первичный ключ со стороны сущности «один» (Подрубрика). При этом первичный ключ Код_подрубрики в наборе атрибутов Заказ становится внешним ключом.
      В отношение, соответствующее сущности со стороны «многие»(Изображения-к-заказу -связь есть), добавляется первичный ключ со стороны сущности «один» (Заказ). При этом первичный ключ Код_заказа в наборе атрибутов Изображения-к-заказу становится внешним ключом.
      В отношение, соответствующее сущности со стороны «многие»(Сообщения -связь может написать), добавляется первичный ключ со стороны сущности «один» (Пользователь). При этом первичный ключ Код_пользователя в наборе атрибутов Сообщение становится внешним ключом.
      В отношение, соответствующее сущности со стороны «многие»(Сообщения -связь образуют), добавляется первичный ключ со стороны сущности «один» (Чат). При этом первичный ключ Код_чата в наборе атрибутов Сообщение становится внешним ключом.
      В отношение, соответствующее сущности со стороны «многие»(Подрубрика -связь есть надрубрика), добавляется первичный ключ со стороны сущности «один» (Надрубрика). При этом первичный ключ Код_надрубрики в наборе атрибутов Подрубрика становится внешним ключом.
      Связь между сущностями Пользователь и Чат становится новое отношение, т. к. между сущностями существует связь многие-ко-многим: состоит. В этой связи внешними ключами будут Код_пользователя и Код_чата, совокупность которых будет являться первичным ключом. Новое отношение будет представлено в виде обновленной сущности Чат с внешними ключами и набором атрибутов.
      
      
      
      
      
      При реализации логической модели она была тщательно проанализирована на предмет нормализации.
      Для уменьшения избыточности информации и исключения аномалий выполняется нормализация исходных схем отношений проекта БД

      Рис. 40 Логическая модель БД




Физическое проектирование БД

Используемые поля:
CharField- строковое поле для хранения коротких или длинных строк;
ImageField-поле изображения
TextField- Большое текстовое поле. Форма использует виджет Textarea.
BooleanField -поле, хранящее значение true/false.
ForeignKey-поле отношений. Связь многое-к-одному. Принимает позиционный аргумент: класс связанной модели. ForeignKey.on_delete-когда объект, на который ссылается ForeignKey, удаляется, Django эмулирует поведение SQL правил, указанных в аргументе on_delete. SET_NULL-Устанавливает ForeignKey в NULL; возможно только если null равен True.
DateTimeField- Дата и время, представленные объектом datetime.datetime Python.
Аргумент: auto_now_add -Значение поля будет автоматически установлено в текущую дату при создании (первом сохранении) объекта.
PhoneNumberField-поле из библиотеки для обработки телефонных номеров.
OneToOneField- связь один-к-одному.
ManyToManyField- связь многие ко многим.
SmallIntegerField- целое число. Допускает значения только в определенной (зависящей от базы данных) точке. Значения от -32768до 32767

Аргументы полей:

max_length - максимальная длинна (в символах) этого поля. max_length используется для проверки данных на уровне базы данных и форм Django
upload_to-путь к изображениям
Сочетание полей blank-True и null-True-делают поле необязательным
verbose_name-Отображаемое имя поля
choices-последовательность, состоящая из кортежа, для использования в качестве вариантов(селектор)
default- значение по умолчанию для поля. 
db_index- если True, для этого поля будет создан индекс базы данных.
region-регион.
on_delete-обязательный параметр при создании ForeingKey.
primary_key-поле первичного ключа для модели.
auto_now_add- автоматически устанавливает для поля значение «Сейчас» при первом создании объекта.
unique- поле должно быть уникальным во всей таблице.

1. Сущности Пользователь-Исполнитель и их связь. Отдельно заказчик не создавался, т.к. поля пользователя совпадают с полями заказчика:





2. Сущности Надрубрика, Подрубрика и их связь через класс Рубрика:







3. Сущности Заказ и Изображения к заказу:




4. Сущность Отклик:



5. Сущность Комментарии:


6. Сущность Чат:



7. Сущность Сообщение:


5 Программная реализация системы
      Особенности фреймворка Django:
      
      Фреймворк Django основан на архитектуре Model-View-Controller (MVC, «Модель-Представление-Контроллер», «Модель-Вид-Контроллер») — схема разделения данных приложения, пользовательского интерфейса и управляющей логики на три отдельных компонента: модель, представление и контроллер — таким образом, что модификация каждого компонента может осуществляться независимо. На рис. 41 показана архитектура MVC.




Рис. 41 Архитектура MVC.

       * URLs:  Можно обрабатывать запросы с каждого URL-адреса с помощью одной функции, но гораздо удобнее писать отдельную функцию для обработки каждого ресурса. URL-mapper используется для перенаправления HTTP-запросов в соответствующее представление на основе URL-адреса запроса. URL-mapper также может извлекать данные из URL-адреса в соответствии с заданным шаблоном и передавать их в соответствующую функцию в виде аргументов.
       * View: Представление (view) - это функция обработчика запросов, которая получает HTTP-запросы и возвращает ответы. View имеет доступ к данным через модели (необходимым для удовлетворения запросов и делегирования ответа в шаблоны).
       * Models: Модели представляют собой объекты Python, которые определяют структуру данных приложения и предоставляют механизмы для управления (добавления, изменения, удаления) и выполнения запросов в базу данных.
       * Templates: Template (шаблон) - это текстовый файл определяющий структуру или разметку страницы (например HTML страницы), с полями для подстановки используемыми для представления актуального содержимого. View может динамически создавать HTML страницы, используя HTML шаблоны и заполняя их данными из модели (model). Шаблон может быть использован для определения структуры файлов любых типов, не обязательно HTML.
       * Формы: HTML-формы используются для сбора пользовательских данных для обработки на сервере. Django упрощает создание, проверку и обработку формы.
       * Аутентификация пользователя и разрешения: Django включает надежную систему аутентификации и авторизации пользователей, которая была построена с учетом безопасности.
       * Кэширование: Создание динамического контента намного более интенсивно (и медленнее), чем обслуживание статического содержимого. Django обеспечивает гибкое кэширование, чтобы вы могли хранить всю или часть отображаемой страницы, для того, чтобы она не вызывалась повторно, за исключением случаев, когда это необходимо.
       * Админ-панель: Административная панель в Django включена по умолчанию при создании приложения с использованием основного каркаса. Это упрощает управление админкой администраторам сайта для создания, редактирования и просмотра любых данных на вашем сайте.

    Общий процесс создания страниц:

       1. Создание изолированной среды Python.
       
       Рекомендуется использовать virtualenv для создания изолированных сред Python, поэтому можно использовать различные версии пакетов для различных проектов, что гораздо более практично, чем установка пакетов Python для всей системы. Другим преимуществом использования virtualenv является то, что для установки пакетов Python не требуются никакие административные привилегии.
       
       	2. Создание приложений.
       
       	 С помощью команды python manage.py startapp ‘название_приложения’.
       
       	3. Активация приложения.
       
       	Чтобы Джанго мог отслеживать наше приложение и имел возможность создавать таблицы баз данных для своих моделей, нужно его активировать. Для этого в файл settings.py(корня) добваляется 'название_приложения' в параметр INSTALLED_APPS.
       
       3. Создание моделей(классов).
       
       Создание в каждом приложении моделей-т. е. сущностей с атрибутами на языке python.
       
       4. Добавление классов на сайт администрирования.
       
       Регистрация моделей в admin.py.
       
       5. Выполнение миграций в БД.
       
       Для создания таблиц в базе данных, Django поставляется с системой миграции для отслеживания изменений, внесенных в модели, и их синхронизации с базой данных. Команда migrate применяет миграцию для всех приложений, перечисленных в INSTALLED_APPS; она синхронизирует базу данных с текущими моделями и миграцией.
       
       Используются команды:
       python manage.py makemigrations
       python manage.py migrate
       
       6. Создание сайта администрирования.
       
       Создание суперпользователя.
       
       7. Визуализация данных.
       
       Отображения на основе функций, базового класса, форм.
       Отображение является функцией, которая обрабатывает HTTP-запрос, получает данные из базы данных (при необходимости), которые применяются для генерации страницы HTML. Затем функция отображения возвращает сгенерированную страницу пользователю в виде HTTP-ответа. 
       
       8. Определение URL-адреса страницы.
       
       URL-преобразования для перехода по соответствующему URL-адресу (с учетом информации, передаваемой в данном адресе) к соответствующей функции отображения.
       
       9. Создание шаблонов
       
       Шаблон - это образец для формирования документа, который будет представлен клиенту: веб-страницы, файла в формате XML, PDF и пр. Подсистема Django, называемая шаблонизатором, загружает шаблон, объединяет его с данными, извлеченными из моделей, полученными от посетителя или сгенерированными в процессе работы, и формирует на основе всего этого полноценный документ, который и отправляется клиенту. Применительно к веб-страницам, шаблон - это файл с НТМL-кодом страницы, содержащий особые команды шаблонизатора: директивы, теги и фильтры. Сами файлы шаблонов веб-страниц должны иметь расширение html.
       
       10. Регистрация URL адресов в корне urls.py
       
       Особенные моменты:
       
       * тэги, зарегестированные в библиотеке (для страницы Каталог), фильтры в шаблонах
       * базовый шаблон для всех страниц с шапкой и подвалом, включающий фреймфорки: jquery 3, Bootstrap 4, js
       * подключение своего файла css(в корне проекта mysite.css )
       
       Для отладки проекта использовался встроенный веб-сервер, лежащий по адресу http://127.0.0.1:8000/


Структура главного приложения


      1. Структура главного приложения 
      
      Новый проект создавался с помощью django-admin startproject mysite. Файловая структура папки показана на рис. 42 mysite является точкой входа для сайта:
      



Рис. 42 структура папки mysite


      Файловая структура представляет собой:
      
      
      * __init__.py - это пустой файл, который инструктирует Python обрабатывать этот каталог как пакет Python.
      * settings.py содержит все настройки сайта. Здесь регестрируются любые приложения, которые создаются, местоположение статических файлов, детали конфигурации базы данных и т. д.  
      * urls.py определяет сопоставления URL-адреса сайта для просмотра. Хотя он может  содержать весь код сопоставления URL-адресов, более распространено делегировать некоторые сопоставления конкретным приложениям.
      * wsgi.py используется, чтобы помочь приложению Django общаться с веб-сервером.
      * asgi.py  является стандартом для асинхронных веб-приложений и серверов Python для взаимодействия друг с другом и позиционируется как асинхронный преемник WSGI, где WSGI предоставляет стандарт для синхронных приложений Python, ASGI предоставляет его как для асинхронных, так и синхронных приложений с WSGI реализация с обратной совместимостью и несколько серверов и каркасов приложений.

      Файл urls.py сайта mysite содержит следующие URL-адреса сайта для просмотра: 
      
urlpatterns = [
    path('captcha/', include('captcha.urls')),
    path('admin/', admin.site.urls),
    path('', include('main.urls')),
    path('', include('advertisement.urls')),
    path('', include('chat.urls')),
]

if settings.DEBUG:
Маршрут для обработки выгруженных файлов:

    urlpatterns+= static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
Маршрут для обработки статических  файлов:

    urlpatterns+= static(settings.STATIC_URL,document_root=settings.STATIC_ROOT)





      Файл settings.py сайта mysite содержит следующие зарегестрированные приложения: 
      
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'bootstrap4',
    'main.apps.MainConfig',
    'phonenumber_field', -библиотека Django для проверки, красивой печати и преобразования телефонных номеров
    'crispy_forms',- библиотека Django, которая предоставляет фильтр и тег, которые позволят управлять поведением рендеринга форм Django очень элегантным способом. Полный контроль без написания пользовательских шаблонов форм.
    'advertisement.apps.AdvertisementConfig',
    'comments.apps.CommentsConfig',
    'chat.apps.ChatConfig',
    'django_cleanup', -приложение Django -очистка автоматически удаляет файлы для FileField, ImageField и подклассы. 
    'easy_thumbnails', -приложение Django  для создания эскизов 
    'django_filters',-это многоразовое приложение Django, позволяющее пользователям декларативно добавлять динамическую QuerySet фильтрацию из параметров URL.
    'captcha',

]

Чтобы Django смог обработать выгруженные посетителями файлы, необходимо установить три дополнительных библиотеки: Easy Thumbnails (создает миниатюры), django-cleanup (удаляет выгруженные файлы после удаления хранящих их записей моделей) и Pillow (обеспечивает поддержку графики, будет автоматически установлена при установке Easy Thumbnails)


 STATIC_ROOT = os.path.join(BASE_DIR, 'static')
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
MEDIA_URL = '/media/'
STATIC_URL = '/static/'

      
      
      STATIC_URL = '/static/'– URL для использования при обращении к статическим файлам, расположенным в STATIC_ROOT.
      
STATIC_ROOT = os.path.join(BASE_DIR, 'static')-файлы, прописанные в коде и в шаблонах.
      
AUTH_USER_MODEL = 'main.User'- переопределение модели пользователя по умолчанию.
MEDIA_ROOT = os.path.join(BASE_DIR,'media') – файлы, которые используются в коде, но известны только в процессе его работы. В данном проекте это файлы в базе данных.
      
MEDIA_URL = '/media/'– URL-адрес, с которого обрабатываются носители MEDIA_ROOT, используемые для управления сохраненными файлами.
      
      Задаем для миниатюр пресет, указывающий выполнять простое масштабирование до размеров 96х96 пикселов. Задаем имя вложенной папки, в которой будут храниться миниатюры, - thumbnails.
      
THUMBNAIL_ALIASES = {
    '': {
        'default': {
            'size': (96,96),
            'crop': 'scale',
        },
    },

}
THUMBNAIL_BASEDIR = 'thumbnails'


      На рис. 43 представлена структура приложения media. На рис. 44 представлена структура приложения static.
      
      	



Рис. 43 Структура приложения media



Рис. 44 Структура приложения static 



2. Создание пользователя, заказчика и исполнителя. Регистрация заказчика/исполнителя. Редактирование личных данных, пароля. Вход, выход, удаление пользователя. 

	Для создания Главной страницы и Пользователей использовалась команда python manage.py startapp main, которая находится внутри проекта mysite. Файловая структура показана на рис. 45:






Рис. 45 Файловая структура приложения Главная (main)

      Файловая структура представляет собой:
      migrations: миграции -  отображает процесс преобразования моделей в БД
      static: располагаются подгружаемые css и js, а так же static-изображения в папке images, используемые на страницах.
      templates:  шаблон - это текстовый файл, определяющий структуру и разметку HTML страницы. Django будет автоматически искать шаблоны в каталоге с именем ' templates ' в приложении. Таким образом,  render() функция ожидает найти файл base.html  в / mysite / main / templates / и выдаст ошибку, если файл отсутствует. 
      urls: определение URL-адреса страницы
      admin.py- регистрация моделей в панели администратора.
      view: представление - функция обработчика запросов. Получает HTTP-запросы и возвращает ответы. 
      models: модели User и Performer представляют собой объект Python, которые определяет структуру данных приложения и предоставляет механизмы для управления (добавления, изменения, удаления) и выполнения запросов в базу данных.
      forms: HTML-формы для сбора пользовательских данных для обработки на сервере. 
      apps.py: объекты конфигурации приложения хранят метаданные для приложения в данном файле.
      
        
	2.1 Создание base.html

	Базовый шаблон base.html создавался в папке mysite / main / templates / layout /. В нем в head прописаны подгружаемые библиотеки: bootstrap 4.4.1, jquery и др., а также собственный файл стилей  mysite.css с помощью тега static(<link rel="stylesheet" type="text/css" href="{% static 'main/style.css' %}">)  Django, который будет искать файлы в папке static. Также был определен стандарт кодирования символов Юникода UTF-8.

<!DOCTYPE html>
{% load bootstrap4 %} подгружаем bootstrap4
{% load static %}%}-подгружаем статичные файлы
 {% bootstrap_css %}
<link rel="stylesheet" type="text/css" href="{% static 'main/style.css' %}">-подгружаем стили
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title> {% block title %} Главная {% endblock %}</title>
{% bootstrap_javascript jquery='full' %}
</head>
<div class="bg-img">
<nav class="navbar navbar-expand-md navbar-light bg-light">

    <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
    </div>
    <div class="mx-auto order-0">
        <a class="" ><a class="navbar-brand mx-auto " href="">
   ORDER.ME<span class="sr-only">(current)</span></a></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".dual-collapse2">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
    <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
    </div>
</nav>
</div>
<body>
<div class="box-hidden">
  <ul class="col nav justify-content-end">
    {% if user.is_authenticated %}
    <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
         aria-expanded="false">Профиль</a>
      <div class="dropdown-menu">
        <a class="dropdown-item" href="{% url 'main:profile' %}">Мой профиль</a>
        {% if user.is_client %}
         <a class="dropdown-item" href="{% url 'advertisement:advertisement_all' %}">Moи заказы</a>
        {% endif %}
          <a class="dropdown-item" href="{% url 'chat:dialogs' %}">Мои сообщения</a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="{% url 'main:logout' %}">Выход</a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="{% url 'main:profile_delete' %}">Удалить профиль</a>
      </div>
    </li>
    {% else %}
      <li class="nav-item">
         <p class="text">Если у вас есть аккаунт, <a href="{% url 'main:login' %}">войдите</a>. Если Вы в первый раз, зарегистрируйтесь
    как <a href="{% url 'main:performer_signup' %}">исполнитель</a>, или как
          <a href="{% url 'main:client_signup' %}">заказчик</a>.</p>
          <a class="nav-link text-right" href="{% url 'main:login' %}"><h6>Bход</h6></a></li>
    {% endif %}
  </ul>
<div class="box">
<div class="row">
  <nav class="col-md-auto nav flex-column border">
    <a class="dropdown-item" href="{% url 'main:index' %}">Главная</a>
    <a class="dropdown-item {% if url_name == 'main:all_performer' %}active{% endif %}" href="{% url 'main:all_performer' %}">Все исполнители</a>
   {% for rubric in rubrics %}
   {% ifchanged rubric.super_rubric.pk %}
<span class="dropdown-item font-weight-bold">{{ rubric.super_rubric.name }}
</span>
  {% endifchanged %}
<a class="dropdown-item" href="{% url 'advertisement:all_rubric' pk=rubric.pk %}">
  {{ rubric.name }}
</a>
  {% endfor %}
  </nav>
  <section class="col border ру-2">
{% bootstrap_messages %}
{% block content %}
{% endblock %}
</section>
</div>
</div>
</div>
</body>
<footer class="py-5 bg-light">
    <div class="container">
      <p class="m-0 text-center text-black">Все права защищены. © 2019 ORDER.ME</p>
    </div>
  </footer>
</div>
</html>

{% block title %} Главная {% endblock %}-Тэги названия страницы
С помощью фреймфорка bootstrap была создана навигационная панель navbar и footer – «подвал».
{% if user.is_authenticated %}-позволяем зарегестрированному пользователю просматривать профиль
{% if user.is_client %}-проверяем, является ли пользователь заказчиком. Если да-то добавляем страницы в профиль.
Добавляем приветственную фразу,которую могут видеть только незарегестрированные пользователи:
<p class="text">Если у вас есть аккаунт, <a href="{% url 'main:login' %}">войдите</a>. Если Вы в первый раз, зарегистрируйтесь
    как <a href="{% url 'main:performer_signup' %}">исполнитель</a>, или как
          <a href="{% url 'main:client_signup' %}">заказчик</a>.</p>

Так же, делаем ссылку на каждую страницу.
Выводим надрубрики-подрубрики и все заказы в основном боковом меню:

{% for rubric in rubrics %}
   {% ifchanged rubric.super_rubric.pk %}
<span class="dropdown-item font-weight-bold">{{ rubric.super_rubric.name }}
</span>
  {% endifchanged %}
<a class="dropdown-item" href="{% url 'advertisement:all_rubric' pk=rubric.pk %}">
  {{ rubric.name }}
</a>
  {% endfor %}


	Блок тегов {% block content %} и {% endblock %} позволят в будущем создавать новые страницы, вверху которых будет навигационная панель, а внизу-footer, а между блоком тэгов - любой код.

      Файл стилей main.css:
      
h2 {
   font-family: Helvetica, sans-serif;
   color: #076EF5;
   position: relative;

}
p {
font-family: Helvetica, sans-serif;
color: black;

}

li a {
    font-family: Helvetica, sans-serif;
    color: black;

}
h3 {
   font-family: Helvetica, sans-serif;
    color: #076EF5
}
h4 {
   font-family: Helvetica, sans-serif;
   color:  #00004d;
}
h5 {
   font-family: Helvetica, sans-serif;
   color: black;
   position: relative;
}
.box-hidden {
  overflow: hidden;
  margin: 50px 10px 10px 50px;
  position: relative;
}

.box-hidden2 {
  overflow: hidden;
  margin: 10px 10px 10px 20px;
  position: relative;

}
.navbar-brand, .navbar-text,
.navbar-nav li a {
    font-family: Helvetica, sans-serif;
    line-height: 100px;
    height: 100px;
    padding-top: 0;
    text-align: center;
    color: black;
    display: inline-block;
    vertical-align: middle;
    position: relative;
}
Главное изображение в заказе:
.main-image {
  width: 200px;
}
Аватар:

.avatar-image {
  border-radius: 50%;
  width: 20px;
}
.advertisement-image {
  width: 100px;
}
.dropdown-menu a{
    font-family: Helvetica, sans-serif;
    color: black;
}
.profile
{
min-height: 355px;
display: inline-block;
}

.profile-banner {
  width: 100%;
  height: 200px;
  background-position: center center;
  background-size: cover;
  position: relative;
  background-color: #252932;
  border-bottom: 4px solid #fff;
  box-shadow: 2px 0px 4px rgba(0,0,0,0.1);
}
.nav-link a {
  color: black;
 }
a {
    color: black; /* Цвет ссылок */
   }
a:visited {
    color: #00004d; /* Цвет посещенных ссылок */
   }
a:active {
    color: red; /* Цвет активных ссылок */
   }
   /* аватар */
.avatar {
    object-fit: cover;
    border-radius:50%;
    width: 150px;
    height: 150px;
}
      
	2.2. Создание страницы index.html.
      
        2.2.1 Для создания главной страницы использовалась логика, представленная методом index в файле vews.py и отображение по шаблону 'main/index.html':

def index(request):
    return render(request, 'main/index.html')
      
      	2.2.2 В начале index.html с помощью тегов был погружен base.html. Таким образом составлялась каждая страница сайта без дублирования кода:
      
      {% extends "main/base.html" %} //подгружаем base.html с помощью тега
           {% block content %}  //открываем блок кода
      
      
{% extends "layout/base.html" %}
{% block content %}
<div class="box-hidden2">
    <h4 class="text-center">Добро пожаловать на наш сайт!</h4>
<p>Здесь вы можете разместить заказ на выполнение изделий ручной
работы по Вашим эскизам, увидеть портфолио исполнителей или зарегистрироваться в качестве исполнителя, чтобы найти
    клиентов.</p>
</div>
    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img class="d-block w-75" src="static/images/Рюкзак.jpg" alt="Первый слайд">
    </div>
    <div class="carousel-item">
      <img class="d-block w-75" src="static/images/Игрушка2.jpg" alt="Второй слайд">
    </div>
  </div>
  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
{% endblock %}

      Для наполнения страницы и ее красивого оформления использовался class="carousel slide" фреймворка bootstrat, наполненный изображениями.
      

{% endblock %}// закрываем блок кода

      2.2.3 URL-адрес главной страницы определен в файле urls.py:
      
urlpatterns = [
    path('', index, name='index'),
]
      
      2.3 Создание Пользователей, Заказчиков и Исполнителей
      
	2.3.1 Для создания пользователей и их ролей, использовались классы AbstractUser, User и Performer.
 	AbstractUser-абстрактный класс пользовательской модели. Создался класс User с наследование AbstractUser для более тщательной настройки под требования проекта. Таким образом, возможно дополнительное создание пользовательских полей. В данном проекте у заказчиков и исполнителей имеются общие поля. Эти общие поля будут добавлены в расширенную модель пользователя User. Так как у исполнителя есть поля, которых нет у заказчика, был создан класс Performer с дополнительными полями. Связь между User и Performer осуществляется через OneToOneField поля user модели Performer. Таким образом, отдельно сущность Заказчик не создавалась, т.к. все поля данной сущности определены в расширенной User модели. Добавились только два Boolean поля для различия пользователей: is_client и is_performer.
      Поле phone_number представлено библиотекой phonenumber_field.
      
class User(AbstractUser):
    is_client = models.BooleanField(default=False, verbose_name='Клиент')
    is_performer = models.BooleanField(default=False, verbose_name='Исполнитель')
    phone_number = PhoneNumberField(region='RU', max_length=12, verbose_name='Телефон', default='', blank=True
)
    city = models.CharField(max_length=30, choices=City_Choices, verbose_name='Город', default='Город')
    avatar=models.ImageField(blank=True, upload_to='images',verbose_name='Аватар')
      
def delete(self, *args, **kwargs):
    for advertisement in self.advertisement_set.all():
        advertisement.delete()
    super().delete(*args, **kwargs)


      Метод def delete() при удалении пользователя удаляет оставленные им заказы.
      
      
	Метакласс:
class Meta(AbstractUser.Meta):
    pass


Поле city представлено City_Choices, значение которых хранится в файле сhoices.py

class Performer(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE, primary_key=True, verbose_name="Пользователь")
    interests = models.CharField(max_length=200, verbose_name="Интересы")
    rubric = models.CharField(max_length=50, default='Рубрика')
    image = models.ImageField(blank=True, upload_to='images',verbose_name='Порфолио')

      
	Стандартный метод класса Python, который возвращал читаемую строку для каждого объекта __str__. Возвращает имя пользователя ( username ):
      
def __str__(self):
    return self.user.username
      
	Метакласс:
class Meta:
    verbose_name = 'Исполнитель'
    verbose_name_plural = 'Исполнители'
      
       В модели Performer были объявлены метаданные уровня модели, которые возвращали удобночитаемое название класса.
	Для создания связи один-к-одному, в классе Performer было создано поле user, являющееся ключом.
      
2.3.2 В файле forms.py представлено несколько форм:

Форма регистрации Исполнителя:

class PerformerForm(UserCreationForm):
Переопределение полей модели:
    interests = forms.CharField(widget=forms.Textarea,label='Опишите свои интересы');
    city = forms.ChoiceField(choices=City_Choices, label='Выберите город');

Переопределение стандартной модели, которую будет использовать UserCreationForm:
    class Meta(UserCreationForm.Meta):
        model = User

Переопределение метода save():
    @transaction.atomic
    def save(self):
        user = super().save(commit=False)
        user.is_performer = True
        user.save()
        performer = Performer.objects.create(user=user)
        performer.interests = self.cleaned_data.get('interests')
        performer.city = self.cleaned_data.get('city')
        performer.save()
        return user

PerformerForm  унаследован от стандартного UserCreationForm. @transaction.atomic-декоратор, позволяющий создать блок кода, в котором гарантируется атомарность базы данных.
 Если блок кода успешно завершен, изменения фиксируются в базе данных. Если есть исключение, изменения отменяются.

Форма регистрации Заказчика:

class ClientForm(UserCreationForm):

Переопределение стандартной модели, которую будет использовать UserCreationForm:
    class Meta(UserCreationForm.Meta):
        model = User

Переопределение поля модели:
    city = forms.ChoiceField(choices=City_Choices);

Переопределение метода save():
@transaction.atomic
    def save(self, commit=True):
        user = super().save(commit=False)
        user.is_client = True
        if commit:
            user.city = self.cleaned_data.get('city')
            user.save()
        return user

ClientForm  унаследована от стандартного UserCreationForm, @transaction.atomic-декоратор, позволяющий создать блок кода, в котором гарантируется атомарность базы данных. Если блок кода успешно завершен, изменения фиксируются в базе данных. Если есть исключение, изменения отменяются.

Для редактирования профилей Исполнителей и Заказчиков, использовался стандартный ModelForm с выборкой полей. Так как не все поля у пользователей общие, то формы были разделены по принципу общности и не общности полей.

Форма с общими для обоих пользователей полями:

class UserForm(forms.ModelForm):
    class Meta:
        model = User
        fields = ['first_name', 'last_name', 'phone_number','city','avatar']

Форма с полями только для Исполнителей:

class ProfileForm(forms.ModelForm):
    class Meta:
        model = Performer
        fields = ['interests','rubric','image']
    rubric = MyModelChoiceField(SubRubric.objects.all(), empty_label="-Ничего не выбрано-", label='Выберите рубрику:')


Так же было создан класс MyModelChoiceField, с возможностью передачи выбора рубрики из класса SubRubric приложения advertisement, который возвращает название надрубрики-подрубрики.

class MyModelChoiceField(forms.ModelChoiceField):
    def label_from_instance(self, obj):
     return obj.name;


	2.3.3 В представлении vews.py прописана логика для возврата веб-ответа с привязкой к созданным формам. А также логика входа, выхода, удаления пользователей.

Регистрация в качестве Исполнителя осуществлена подклассом контроллер-класса CreateView на основе PerformerForm:

class PerformerView(CreateView):
    model = User
    form_class = PerformerForm
    template_name = 'main/performer_registration.html'

    def get_context_data(self, **kwargs):
        kwargs['user_type'] = 'performer'
        return super().get_context_data(**kwargs)
    
    def form_valid(self, form):
        user = form.save()
        login(self.request, user)
        return redirect('/')


Регистрация в качестве Заказчика осуществлена подклассом контроллер-класса CreateView на основе ClientForm:

class ClientViews(CreateView):
    model = User
    form_class = ClientForm
    template_name = 'main/performer_registration.html'

    def get_context_data(self, **kwargs):
        kwargs['user_type'] = 'client'
        return super().get_context_data(**kwargs)

    def form_valid(self, form):
        user = form.save()
        login(self.request, user)
        return redirect('/')


Контроллер-класс входа для всех зарегистрированных пользователей на основе подкласса контроллера-класса LoginView:

class UserLoginView(LoginView):
    template_name = 'main/login.html'


Функция, реализующая представление профиля:

@login_required
def profile(request):
    try:
        performer = request.user.performer
    except Performer.DoesNotExist:
        performer = Performer(user=request.user)
    return render(request, 'main/profile.html',{'performer':performer})

Страница пользовательского профиля должна быть доступна только зарегистрированным пользователям, выполнившим вход на сайт, поэтому мы пометили контроллер-функцию profile () декоратором login _ required (). 

Контроллер-класс выхода для всех пользователей:

class LogOutView(LoginRequiredMixin, LogoutView):
    template_name = 'main/logout.html'

Страница выхода должна быть доступна только зарегистрированным пользователям, выполнившим вход. Поэтому добавили в число суперклассов контроллер-класса LogoutView примесь LoginRequiredМixin.


Контроллер-функция изменения личных данных Заказчика на UserForm основе и Исполнителя на основе ProfileForm:

def update_profile(request):
    user = request.user
    performer = Performer()
    performer.user = user
    if request.method == 'POST':
        form_user = UserForm(request.POST or None,files=request.FILES, instance=request.user)
        form_extended = ProfileForm(request.POST or None, files=request.FILES,instance=request.user.performer)
        if form_user.is_valid() and form_extended.is_valid():
            form_user.save()
            form_extended.save()
            messages.success(request, 'Ваш профиль был успешно обновлен!')
            return redirect('main:profile')
        else:
            if form_user.is_valid():
                form_user.save()
                messages.success(request, 'Ваш профиль был успешно обновлен!')
                return redirect('main:profile')
            else:
                messages.error(request, 'Пожалуйста, заполните все пункты.')
    else:
        form_user = UserForm(instance=request.user)
        form_extended = ProfileForm(instance=request.user.performer)
    return render(request, 'main/change_user_info.html', {'form_user': form_user, 'form_extended': form_extended})

Контроллер-функция определяет тип пользователя, а так же заполнение всех полей формы и вложенных файлов, и обновляют форму с новыми параметрами.
Параметр files=request.FILES позволяет пользователю загружать изображения на сайт.
После успешной смены пароля выполняем перенаправление на страницу профиля пользователя с выводом соответствующего всплывающего сообщения.

Контроллер-класс смены пароля для всех пользователей, производный от класса PasswordChangeView:

class ChangePassword(SuccessMessageMixin, LoginRequiredMixin, PasswordChangeView):
    template_name = 'main/password_change.html'
    success_url = reverse_lazy('main:profile')
    success_message = 'Пароль изменен'

После успешной смены пароля выполняем перенаправление на страницу профиля пользователя с выводом соответствующего всплывающего сообщения.

Контроллер-класс удаления пользователей, производный от класса DeleteView:

class DeleteUser(LoginRequiredMixin,DeleteView):
    model = User
    template_name = 'main/delete_user.html'
    success_url = reverse_lazy('main:index')

    def setup(self, request, *args, **kwargs):
        self.user_id = request.user.pk
        return super().setup(request, *args, **kwargs)

    def post(self, request, *args, **kwargs):
        logout(request)
        messages.add_message(request, messages.SUCCESS,'Пользователь удален')
        return super().post(request, *args, **kwargs)

    def get_object(self, queryset=None):
        if not queryset:
            queryset = self.get_queryset()
        return get_object_or_404(queryset, pk=self.user_id)

Контроллер-функция вывода всех Исполнителей. Декоратор @login_required позволяет показывать представление только для зарегистрированных пользователей. Так же в файле filters.py размещен фильтр, позволяющий в динамическом режиме фильтровать исполнителей по городам (код представлен в п 2.3.4):

@login_required
def all_performer(request):
    users=Performer.objects.all()
    user_filter = UserFilterAdd(request.GET, queryset=users)
    context={'users':users,'filter': user_filter}
    return render(request,'main/all_performer.html',context)

user_filter -в динамическом режиме фильтрует исполнителей по городам

Контроллер-функция представления каждого Исполнителя:

def all_performer_detail(request, pk):
    performers=get_object_or_404(Performer, pk=pk)
    return render(request,'main/performer_detail.html',{'performers': performers})




2.3.4 Шаблоны представлений находятся в папке main/templates/main. Рассмотрим их подробнее: 

Performer_registration.html-шаблон регистрации гостя:

{% extends "layout/base.html" %}-наследуем базовый шаблон
{% load crispy_forms_tags %}
{% block content %}
<div class="box-hidden2">
  <div class="row">
    <div class="col-md-8 col-sm-10 col-12">
      {% if user_type == 'client' %}
        <h4>Зарегистрироваться в качестве: заказчика</h4>
        {% else %}
      <h4>Зарегистрироваться в качестве: исполнителя</h4>
{% endif %}
      <form method="post" novalidate>
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ next }}">
        {{ form|crispy }}
        <button type="submit" class="btn btn-success">Зарегистироваться</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}


{% load crispy_forms_tags %} –загружаем crispy_forms

{% if user_type == 'client' %}-проверяем, в качестве кого хочет зарегистрироваться гость. В соответствии с этим, выводится form.


profile.html-шаблон профиля пользователя:

{% extends "layout/base.html" %}
{% load static %}
{% block title %}Профиль пользователя {{ user.get_username }}{% endblock %}
{% block content %}
{% if user.is_performer %}
<div class="box-hidden2">
     <div class="text-center text-sm-right">
         <span class="badge badge-success">исполнитель</span>
         <h4>Профиль пользователя {{ user.get_username }} </h4>
     </div>
    {% else %}
    <div class="box-hidden2">
        <div class="text-center text-sm-right">
            <span class="badge badge-success">заказчик</span>
            <h4>Профиль пользователя {{ user.get_username }} </h4>
        </div>
        {% endif %}
    </div>
    <div class="box-hidden2">
        <div class="row gutters-sm">
            <div class="col-md-4 mb-3">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            {% if user.avatar %}
                            <img src="{{ user.avatar.url }}" alt="Avatar" class="avatar">
                            {% else %}
                            <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle" width="150">
                            {% endif %}
                            <div class="mt-3">
                                <h4>{{ user.get_username }}</h4>
                                {% if user.city %}
                                <p class="text-secondary mb-1">{{ user.get_city_display }}</p>
                                {% else %}
                                <p class="text-secondary mb-1">Город не указан</p>
                        {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
              <div class="card mb-3">
                  <div class="card-body">
                      <div class="row">
                          <div class="col-sm-3">
                              <h6 class="mb-0">Полное имя</h6>
                          </div>
                          {% if user.first_name or user.last_name %}
                          <div class="col-sm-9 text-secondary">
                              {{ user.first_name }} {{ user.last_name }}
                          </div>
                          {% else %}
                          <div class="col-sm-9 text-secondary">
                              {{ user.get_username }}
                          </div>
                          {% endif %}
                      </div>
                      <hr>
                      <div class="row">
                          <div class="col-sm-3">
                              <h6 class="mb-0">Телефон</h6>
                          </div>
                          {% if user.phone_number %}
                          <div class="col-sm-9 text-secondary">
                              {{ user.phone_number }}
                          </div>
                          {% else %}
                          <div class="col-sm-9 text-secondary">
                              Телефон не указан
                          </div>
                          {% endif %}
                      </div>
                      <hr>
                      <div class="row">
                          <div class="col-sm-3">
                              {% if user.city %}
                              <h6 class="mb-0">Город</h6>
                          </div>
                          <div class="col-sm-9 text-secondary">
                              {{ user.get_city_display }}
                          </div>
                          {% else %}
                          <div class="col-sm-9 text-secondary">
                              Город не указан
                          </div>
                          {% endif %}
                      </div>
                      <hr>
                      {% if user.is_performer %}
                      <div class="row">
                          <div class="col-sm-3">
                              <h6 class="mb-0">Интересы</h6>
                          </div>
                          {% if performer.interests %}
                          <div class="col-sm-9 text-secondary">
                              {{ performer.interests }}
                          </div>
                          {% else %}
                          <div class="col-sm-9 text-secondary">
                          Интересы не выбраны
                          </div>
                          {% endif %}
                      </div>
                      <hr>
                      <div class="row">
                          <div class="col-sm-3">
                              <h6 class="mb-0">Рубрика</h6>
                          </div>
                          {% if performer.rubric %}
                          <div class="col-sm-9 text-secondary">
                              {{ performer.rubric }}
                          </div>
                          {% else %}
                          <div class="col-sm-9 text-secondary">
                              Рубрика не выбрана
                          </div>
                          {% endif %}
                      </div>
                      <hr>
                      <div class="row">
                          <div class="col-sm-3">
                              <h6 class="mb-0">Портфолио</h6>
                          </div>
                          {% if performer.image %}
                          <img src="{{ performer.image.url }}" class="main-image">
                          {% else %}
                          {% endif %}
                      </div>
                  </div>
                  {% endif %}
                  <div class="btn-group" role="group" aria-label="Basic example">
                      <a class="btn btn-info btn-sm" role="button" href="{% url 'main:profile_change' %}">ИЗМЕНИТЬ ЛИЧНЫЕ ДАННЫЕ</a>
                      <a class="btn btn-success btn-sm" role="button" href="{% url 'main:password_change' %}">ИЗМЕНИТЬ ПАРОЛЬ</a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    {% endblock %}

При помощи значка <span class="badge badge-success"> выводим тип пользователя в профиле.
Для отображения профиля применен <div class="row">, который использует серию контейнеров, строк и столбцов для компоновки и выравнивания содержимого. В начале выводим общие поля, которые принадлежат обоим пользователям, после проверяем тип пользователя, и если тип это исполнитель {% if user.is_performer %}, выводим оставшиеся поля для него.
В конце страницы создаем группу из двух кнопок со ссылками на соответствующие страницы:
<div class="btn-group" role="group" aria-label="Basic example">
                      <a class="btn btn-info btn-sm" role="button" href="{% url 'main:profile_change' %}">ИЗМЕНИТЬ ЛИЧНЫЕ ДАННЫЕ</a>
                      <a class="btn btn-success btn-sm" role="button" href="{% url 'main:password_change' %}">ИЗМЕНИТЬ ПАРОЛЬ</a>

change_user_info.html-шаблон изменения личных данных пользователя:

{% extends "layout/base.html" %}
{% load crispy_forms_tags %}
{% load bootstrap4 %}
{% block title %} Правка личных данных пользователя {{ user.get_username }}{% endblock %}
{% block content %}
<h4 class="text-center">Правка личных данных пользователя {{ user.get_username }}</h4>
<div class="box-hidden2">
    <form method="post" form enctype="multipart/form-data">
        {% csrf_token %}
        {% if user.is_performer %}
        {{ form_user|crispy }}
        {{ form_extended|crispy }}
        {% else %}
        {{ form_user|crispy }}
        {% endif %}
        <div class="float-left">
            <button type="submit" class="btn btn-info btn-sm">РЕДАКТИРОВАТЬ</button>
        </div>
    </form>
</div>
{% endblock %}

Так как представление изменений личных данных разбито на две формы: одна с общими полями, вторая только для исполнителей, мы сначала проверяем тип пользователя {% if user.is_performer %}, ели тип-исполнитель-выводим сразу две формы:
        {{ form_user|crispy }}
        {{ form_extended|crispy }}
В противном случае выводим одну:
        {% else %}
        {{ form_user|crispy }}
        {% endif %}

password_change.html-шаблон изменения пароля пользователя:

{% extends "layout/base.html" %}
{% load bootstrap4
{% load crispy_forms_tags %}
{% block title %} Смена пароля пользователя {{ user.get_username }}{% endblock %}
{% block content %}
<h4 class="text-center">Смена пароля пользователя {{ user.get_username }}</h4>
<div class="box-hidden2">
 <form method="post">
  {% csrf_token %}
  {{ form|crispy }}
  <button type="submit" class="btn btn-info btn-sm">ИЗМЕНИТЬ</button>
 </form>
</div>
{% endblock %}

Код простой: выводим форму смены пароля {{ form|crispy }}.

login.html-шаблон входа пользователя:

{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block title %}Вход{% endblock %}
{% block content %}
<div class="box-hidden2">
    <div class="text-left">
        <h4>Вход</h4>
    </div>
</div>
<div class="box-hidden2">
    {% if user.is_authenticated %}
    <p>Вы уже выполнили вход.</p>
    {% else %}
    <form method="post">
        {% csrf_token %} 
        {% bootstrap_form form layout='horizontal' %}
        <input type="hidden" name="next" value="{{ next }}">
        <div class="text-right">
            {% buttons submit='Boйти' %} {% endbuttons %}
        </div>
    </form>
    {% endif %}
</div>
{% endblock %}

Проверяем, вошел ли пользователь в систему с помощью {% if user.is_authenticated %}. Если вошел, выводим надпись <p>Вы уже выполнили вход.</p>.Если не вошел, загружается форма входа с кнопкой Войти:
    <form method="post">
        {% csrf_token %} 
        {% bootstrap_form form layout='horizontal' %}
        <input type="hidden" name="next" value="{{ next }}">
        <div class="text-right">
            {% buttons submit='Boйти' %} {% endbuttons %}
        </div>
    </form>

logout.html-шаблон выхода пользователя:
Шаблон срабатывает после нажатие кнопки Выход в профиле пользователя: <a class="dropdown-item" href="{% url 'main:logout' %}">Выход</a>:

{% extends "layout/base.html" %}
{% block title %}Выход{% endblock %}
{% block content %}
<div class="box-hidden2">
<div class="text-center">
    <h4>Выход</h4>
    <p>Вы успешно вышли с сайта.</p>
</div>
</div>
{% endblock %}


delete_user.html-шаблон удаления пользователя:

all_performer.html-шаблон вывода всех исполнтелей:

{% extends "layout/base.html" %}
{% load crispy_forms_tags %}
{% block title %}Все исполнители{% endblock %}
{% block content %}
<div class="box-hidden2">
    <div class="text-center">
        <h4 >Все исполнители</h4>
    </div>
</div>
<div class="box-hidden2">
    {% for performer in filter.qs %}
    <ul class="list-group">
     <li class="list-group-item list-group-item-primary"> <a href="{% url 'main:performer_detail' pk=performer.pk %}">
         <h5>{{ performer.user.get_username }}</h5></a></>
    </ul>
    {% endfor %}
    <div class="box-hidden2">
        <div class="text-center">
            <h4> Фильтр </h4>
            <h5>Выберите город:</h5>
            <form method="get">
                {{ filter.form.new_name.label_tag }} 
                {{ filter.form.as_p }}
                <button type="submit" class="btn btn-primary">ИСКАТЬ</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

Шабон вывода всех исполнителей:  {% for performer in filter.qs %} использует динамический фильтр с возможностью фильтрации по городам:
<form method="get">
                {{ filter.form.new_name.label_tag }} 
                {{ filter.form.as_p }}
                <button type="submit" class="btn btn-primary">ИСКАТЬ</button>

performer_detail.html-шаблон детальной информации по каждому исполнителю:
{% extends "layout/base.html" %}
{% block title %}Профиль пользователя {{ performers.user.get_username }}{% endblock %}
{% block content %}
<div class="box-hidden2">
    <div class="text-center text-sm-right">
        <span class="badge badge-success">исполнитель</span>
        <div class="text-right">
            <h4>Профиль пользователя {{ performers.user.get_username }}</h4>
        </div>
    </div>
</div>
<div class="box-hidden2">
    <div class="row gutters-sm">
            <div class="col-md-4 mb-3">
              <div class="card">
                <div class="card-body">
                  <div class="d-flex flex-column align-items-center text-center">
                      {% if performers.user.avatar %}
                      <img src="{{ performers.user.avatar.url }}" alt="Avatar" class="avatar">
                      {% else %}
                      <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle" width="150">
                      {% endif %}
                      <div class="mt-3">
                          <h4>{{ performers.user.get_username }}</h4>
                          {% if performers.user.city %}
                          <p class="text-secondary mb-1">{{ performers.user.get_city_display }}</p>
                          {% endif %}
                      </div>
                  </div>
                </div>
              </div>
            </div>
        <div class="col-md-8">
            <div class="card mb-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Полное имя</h6>
                        </div>
                        {% if performers.user.first_name or performers.user.last_name %}
                        <div class="col-sm-9 text-secondary">
                            {{ performers.user.first_name }} {{ performers.user.last_name }}
                        </div>
                        {% else %}
                        <div class="col-sm-9 text-secondary">
                            Нет имени
                        </div>
                        {% endif %}
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Телефон</h6>
                        </div>
                        {% if performers.user.phone_number %}
                        <div class="col-sm-9 text-secondary">
                            {{ performers.user.phone_number }}
                        </div>
                        {% else %}
                        <div class="col-sm-9 text-secondary">
                            Телефон не указан
                        </div>
                        {% endif %}
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            {% if performers.user.city %}
                            <h6 class="mb-0">Город</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            {{ performers.user.get_city_display }}
                        </div>
                        {% else %}
                        <div class="col-sm-9 text-secondary">
                            Город не указан
                        </div>
                        {% endif %}
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            {% if performers.interests %}
                            <h6 class="mb-0">Интересы</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            {{ performers.interests }}
                        </div>
                        {% else %}
                        <div class="col-sm-9 text-secondary">
                            Интересы не выбраны
                        </div>
                        {% endif %}
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Рубрика</h6>
                        </div>
                        {% if performers.rubric %}
                        <div class="col-sm-9 text-secondary">
                            {{ performers.rubric }}
                        </div>
                        {% else %}
                        <div class="col-sm-9 text-secondary">
                            Рубрика не выбрана
                        </div>
                        {% endif %}
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Портфолио</h6>
                        </div>
                        {% if performers.image %}
                        <img src="{{ performers.image.url }}" class="main-image">
                        {% else %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% if user.is_client %}
<a class="btn btn-success float-right" href="{% url 'chat:create_dialog' performers.pk %}" role="button ">Написать сообщение</a>
{% endif %}
{% endblock %}

Код этой страницы идентичен коду профиля пользователя, кроме передаваемого контекстного имени и отсутствия проверки на тип пользователя, так как мы выводим всех исполнителей.
В нижн представленном фрагменте кода: {% if user.is_client %}
<a class="btn btn-success float-right" href="{% url 'chat:create_dialog' performers.pk %}" role="button ">Написать сообщение</a>
{% endif %} мы проверяем, какой тип пользователя зашел на страницу. Если это заказчик, то он может написать личное сообщение.

      
2.3.5 Код фильтра filters.py:

class UserFilterAdd(django_filters.FilterSet):
    user__city = df.ChoiceFilter( choices=City_Choices,empty_label='-Ничего не выбрано-',label='')
    class Meta:
        model=Performer
        fields=['user__city']

поле 'user__city' является фильтруемым значением.
      
      2.3.6 URL-адрес страниц определены в файле urls.py. Так же в этом файле представлено app_name- пространства имен приложений включенных URLconf_моделей. По этому имени возможно обращение из других приложений:
      
app_name = 'main'
urlpatterns = [
    path('', index, name='index'),
    Создали страницу регистрации Исполнителя:
    path('accounts/performer', PerformerView.as_view(), name='performer_signup'),
    Создали страницу регистрации Заказчика:
    path('accounts/client',ClientViews.as_view(), name='client_signup'),
    Создали представление входа пользователей:
    path('accounts/login/', UserLoginView.as_view(), name='login'),
    Представление профиля пользователей:
    path('accounts/profile/', profile, name='profile'),
    Удаление пользователя:
    path('accounts/profile/delete/', DeleteUser.as_view(), name='profile_delete'),
    Правка личных данных пользователей:
    path('accounts/profile/change', update_profile, name='profile_change'),
    Выход пользователей из профиля:
    path('accounts/logout/', LogOutView.as_view(), name='logout'),
    Правка пароля пользователей:
    path('accounts/password/change/', ChangePassword.as_view(), name='password_change'),

    Выводим всех исполнителей
    path('search/performers',all_performer,name='all_performer'),
    Выводим каждого исполнителя
    path('performer/<int:pk>/',all_performer_detail ,name='performer_detail'),

]

      
      2.3.7 Модели были зарегистрированы в панели администратора admin.py:
       
class PerformerInline(admin.StackedInline):
    model = Performer
    can_delete = False
    verbose_name_plural = 'Исполнитель'
    fk_name = 'user'

class CustomUserAdmin(UserAdmin):
    inlines = (PerformerInline,)
    list_display = ('username','first_name', 'last_name', 'is_client', 'is_performer','city')
    list_select_related = ('performer',)

    def get_inline_instances(self, request, obj=None):
        if not obj:
            return list()
        return super(CustomUserAdmin, self).get_inline_instances(request, obj)



admin.site.register(User, CustomUserAdmin)
      

      2.3.8 Файл apps.py содержит следующий код:
      
class MainConfig(AppConfig):
    name = 'main'
    verbose_name = 'Главная страница сайта'
      
      AppConfig.name определяет полный путь python к приложению. 
      AppConfig.verbose_name удобночитаемое название приложения: «Главная страница сайта»
      
      

3. Создание Надрубрики-Подрубрики, Заказа, Иллюстраций к заказам. Возможность откликаться на заказы.
	Для создания приложения Заказы использовалась команда python manage.py startapp advertisement, которое находится внутри проекта mysite. Файловая структура показана на рис. 46:



Рис. 46 Файловая структура приложения Заказы (advertisement)

      Файловая структура представляет собой:
      migrations: миграции -  отображает процесс преобразования моделей в БД
      static: располагаются подгружаемые css и js, а так же static-изображения в папке images, используемые на страницах.
      templates:  шаблон - это текстовый файл, определяющий структуру и разметку HTML страницы. Django будет автоматически искать шаблоны в каталоге с именем ' templates ' в приложении. Таким образом render() функция ожидает найти файл .html  в / mysite / advertisement / templates / и выдаст ошибку, если файл отсутствует. Таким же образом будет найден шаблон для нового тэга, созданного по необходимости. Render() функция ожидает найти файл .html  в / mysite / advertisement / templates / tags/ и выдаст ошибку, если файл отсутствует.
      templatetags: Django содержит большое количество встроенных тегов и фильтров. Иногда требуется  добавить собственный функционал к шаблонам. В этой папке хранятся созданные новые тэги.
      urls: определение URL-адреса страницы
      admin.py- регистрация моделей в панели администратора.
      view: представление - функция обработчика запросов. Получает HTTP-запросы и возвращает ответы. 
      models: модели Rubric, SubRubric и др. представляют собой объект Python, которые определяет структуру данных приложения и предоставляет механизмы для управления (добавления, изменения, удаления) и выполнения запросов в базу данных.
      forms: HTML-формы для сбора пользовательских данных для обработки на сервере. 
      apps.py: объекты конфигурации приложения хранят метаданные для приложения в данном файле.


3.1 Создание класса Rubric и менеджеров SuperRubricManager и SubRubricManager. Создание классов Advertisement(заказ), AdvertisementImage, Respond

class Rubric(models.Model):
    name = models.CharField(max_length=40, db_index=True, unique=True, verbose_name='Название рубрики')
    order = models.SmallIntegerField(default=0, db_index=True, verbose_name='Порядок рубрик')
    super_rubric = models.ForeignKey('SuperRubric', on_delete=models.PROTECT, null=True, blank=True,  verbose_name='Надрубрика')


	Поле order будет хранить целое число, обозначающее порядок следования рубрик друг за другом. 
	Поле super_rubric будет хранить надрубрику, к которой относится текущая подрубрика. Это поле будет заполняться только в том случае, если запись хранит подрубрику. on_delete=models.PROTECT- запрещает каскадное удаление записей. 

	Объявляем диспетчера записей SuperRubricМanager:

class SuperRubricManager(models.Manager):
    def get_queryset(self):
        return super().get_queryset().filter(super_rubric__isnull=True)

def get_queryset(self)-метод выбирает только записи с пустым полем super _ rubric, т. е. надрубрики.

Объявляем прокси-модель SuperRubric:

class SuperRubric(Rubric):
    objects = SuperRubricManager()

	Стандартный метод класса Python, который возвращал читаемую строку для каждого объекта __str__. Возвращает название рубрики (name ).

    def __str__(self):
        return self.name
Метакласс:
    class Meta:
        proxy = True
        ordering = ('order', 'name')
        verbose_name = 'Надрубрика'
        verbose_name_plural = 'Надрубрики'


	Поле ordering  указывает сортировку записей сначала по возрастанию значения порядка, а потом - по названию.

Объявляем диспетчера записей SubRubricManager:

class SubRubricManager(models.Manager):
    def get_queryset(self):
        return super().get_queryset().filter(super_rubric__isnull=False)

Объявляем прокси-модель SubRubric:

class SubRubric(Rubric):
    objects = SubRubricManager()

	Стандартный метод класса Python, который возвращал читаемую строку для каждого объекта __str__. Возвращает строку в виде “имя_надрубрики-имя_подрубрики”( self.super_rubric.name, self.name).

    def __str__(self):
        return '%s - %s' % (self.super_rubric.name, self.name)

Метакласс:
    class Meta:
        proxy = True
        ordering = ('super_rubric__order', 'super_rubric__name', 'order',
                    'name')
        verbose_name = 'Подрубрика'
        verbose_name_plural = 'Подрубрики'

	Поле ordering сортируют записи по порядку надрубрики, названию надрубрики, порядку подрубрики и названию подрубрики.

Создание класса Заказа:

class Advertisement(models.Model):
      rubric=models.ForeignKey(SubRubric,on_delete=models.PROTECT,verbose_name='Рубрика')
    author=models.ForeignKey(User,on_delete=models.CASCADE, verbose_name='Автор объявления')
    title=models.CharField(max_length=40,verbose_name='Название заказа')
    description=models.TextField(verbose_name='Описание заказа')
    image=models.ImageField(blank=True, verbose_name='Прикрепить изображение')          is_active=models.BooleanField(default=True,db_index=True,verbose_name='Актуальность')
    data=models.DateTimeField(auto_now_add=True,db_index=True,verbose_name='Дата публикации')
      
      
      Поле rubric класса Advertisement определяет отношение «многие к одному» через ForeignKey к классу SubRubric, т.к. заказов у подрубрики может быть много. on_delete- определяет то, как должна работать связь, в данном случае: models.PROTECT-препятствует удалению связанного объекта вызывая исключение.
      Поле author класса Advertisement определяет отношение «многие к одному» через ForeignKey к классу User, т.к. автора может быть несколько заказов. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - Каскадное удаление. 

    def delete(self, *args,**kwargs):
        for ai in self.advertisementimage_set.all():
            ai.delete()
        super().delete(*args,**kwargs)

      В переопределенном методе delete () перед удалением текущего заказа мы перебираем и вызовом метода delete () удаляем все связанные дополнительные иллюстрации. При вызове метода delete () возникает сигнал post _ delete, обрабатываемый приложением django _ cleanup, которое в ответ удалит все файлы, хранящиеся в удаленной записи.
Метакласс:
    class Meta:
        verbose_name = 'Объявление'
        verbose_name_plural = 'Объявления'
        ordering = ['-data']

Поле ordering сортируют записи по дате добавления.
      
Создание класса Изображения-к-заказу:
      
class AdvertisementImage(models.Model):
    adv=models.ForeignKey(Advertisement,on_delete=models.CASCADE,verbose_name='Объявления')
    image=models.ImageField(verbose_name='Дополнительная иллюстрация')
Метакласс:
    class Meta:
        verbose_name = 'Дополнительные иллюстрации'
        verbose_name_plural = 'Дополнительная иллюстрация'

Поле adv класса AdvertisementImage определяет отношение «многие к одному» через ForeignKey к классу Advertisement, т.к. заказ может иметь много иллюстраций. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - каскадное удаление. 



Создание отклика на заказ:

class Respond(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    advertisement = models.ForeignKey(Advertisement, on_delete=models.CASCADE)
    timestamp = models.DateTimeField(auto_now=True, auto_now_add=False)

      Поле user класса Respond определяет отношение «многие к одному» через ForeignKey к классу User, т.к. у исполнителя может быть несколько откликов. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - каскадное удаление. 
      Поле advertisement класса Respond определяет отношение «многие к одному» через ForeignKey к классу  Advertisement, т.к. исполнитель может откликнуться на несколько заказов. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - Каскадное удаление. 
      


Стандартный метод класса Python, который возвращал читаемую строку для каждого объекта __str__. Возвращает имя пользователя ( advertisement.title ).

    def __str__(self):
        return self.advertisement.title
Метакласс:
    class Meta:
        verbose_name = 'Отклики'
        verbose_name_plural = 'Отклик'


      В модели были объявлены метаданные уровня моделей, которые возвращали удобночитаемое название класса.

3.2 В файле forms.py представлено несколько форм:

class SearchForm(forms.Form):
    keyword=forms.CharField(required=False,max_length=20,label='')

class SubRubricForm(forms.ModelForm):
    super_rubric = forms.ModelChoiceField(queryset=SubRubric.objects.all(),empty_label=None,  required=True, label='Надрубрика')

    class Meta:
        model = SubRubric
        fields = '__all__'

Убран пустой пункт у раскрывающегося списка, с помощью которого пользователь будет выбирать подрубрику, присвоив параметру empty_label конструктора класса поля ModelChoiceField значение None. 




Форма добавления заказа заказчиком

class AdvertisementForm(forms.ModelForm):
    class Meta:
        model=Advertisement
        fields='__all__'
        widgets={'author':forms.HiddenInput}-скрытой поле автора

AIFormSet=inlineformset_factory(Advertisement,AdvertisementImage,fields='__all__')

AIFormSet -набор форм - это уровень абстракции для работы с несколькими формами на одной странице. Таким образом можно вывести две модели Advertisement и AdvertisementImage в одной форме.

Форма отклика на заказ:

class ApplyForm(forms.ModelForm):
    class Meta:
        model = Respond
        fields = ['advertisement']


3.3 В файле middlewares.py написан код обработчика контекста mysite_context_processor(), с помощью которого можно вывести все надрубрики-подрубрики в вертикальной панели основного меню, а также реализует корретный возврат страницы при поиске:

def mysite_context_processor(request):
    context = {}
    context['rubrics'] = SubRubric.objects.all()
    context['keyword'] = ''
    context['all'] = ''
    if 'keyword' in request.GET:
        keyword = request.GET['keyword']
        if keyword:
            context['keyword'] = '?keyword=' + keyword
            context['all'] = context['keyword']
    if 'page' in request.GET:
        page = request.GET['page']
        if page != '1':
            if context['all']:
                context['all'] += '&page=' + page
            else:
                context['all'] = '?page' + page
    return context


В модуле settings.py пакета конфигурации зарегистрируем только что написанный обработчик контекста. Для этого добавим имя этого обработчика в список context _proces sors из параметра OPTIONS:
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                …,
                'advertisement.middlewares.mysite_context_processor',
            ],
        },
    },
]

В base.html фрагмент вывода надрубрик-подрубрик будет записан как:

{% for rubric in rubrics %}
   {% ifchanged rubric.super_rubric.pk %}
<span class="dropdown-item font-weight-bold">{{ rubric.super_rubric.name }}
</span>
  {% endifchanged %}
<a class="dropdown-item" href="{% url 'advertisement:all_rubric' pk=rubric.pk %}">
  {{ rubric.name }}
</a>
  {% endfor %}




3.4 В представлении vews.py прописана логика для вывода всех заказов в выбранной рубрике, детального отображения выбранного заказа, функция добавления заказа, удаления, редактирования. Так же, написаны представления для возможности откликнуться на заказ, просмотреть отклики. 

Контроллер функция, выводящая все заказы в выбранной подрубрике:

def all_rubric(request,pk):
    rubric=get_object_or_404(SubRubric,pk=pk)
    adv=Advertisement.objects.filter(is_active=True,rubric=pk)
    if 'keyword' in request.GET:
        keyword=request.GET['keyword']
        q= Q(title__icontains=keyword) | Q(description__icontains=keyword)
        adv=adv.filter(q)
    else:
        keyword=''
    form=SearchForm(initial={'keyword': keyword})
    paginator=Paginator(adv,2)
    if 'page' in request.GET:
        page_num=request.GET['page']
    else:
        page_num=1
    page=paginator.get_page(page_num)
    context={'rubric': rubric,'page':page,'adv': page.object_list,'form':form}
    return render(request,'advertisement/all_rubric.html',context)

Контроллер функция, реализующая детальную информацию по выбранному заказу, а также отображение комментариев:

def rubric_detail(request, rubric_pk, pk):
    global form_class
    advertisement=get_object_or_404(Advertisement, pk=pk)
    ais = advertisement.advertisementimage_set.all()
    comments=Comments.objects.filter(advertisement=pk,is_active=True)
    initial={'advertisement': advertisement.pk}
    if request.user.is_authenticated:
        initial['author']=request.user.username
        form_class = UserCommentForm
    else:
        form_class=UserCommentForm
        messages.error(request, 'Войдите чтобы написать комментарий.')
    form = form_class(initial=initial)
    if request.method == 'POST':
        c_form = form_class(request.POST)
        if c_form.is_valid():
            c_form.save()
            messages.add_message(request,messages.SUCCESS,'Комментарий добавлен')
        else:
            form =UserCommentForm
            messages.add_message(request,messages.WARNING,'Комментарий не добавлен')
    context = {'advertisement':advertisement,'ais':ais,'comments':comments,'form': form}
    return render(request, 'advertisement/rubric_detail.html', context)

Строка initial['author']=request.user.username- означает получений имени вошедшего в систему пользователя автоматически в поле 'author' модели Comments.

После успешного написания комментария появляется сообщение с выводом соответствующего всплывающего сообщения. Для незарегистрированных пользователей есть возможность просматривать комментарии, но не писать их.



Контроллер-функция, реализующая добавление объявления на основе AdvertisementForm:

def advertisement_add(request):
    if request.method == 'POST':
        form = AdvertisementForm(request.POST,request.FILES)
        if form.is_valid():
            adv = form.save()
            formset = AIFormSet(request.POST, request.FILES, instance=adv)
            if formset.is_valid():
                formset.save()
                messages.add_message(request, messages.SUCCESS, 'Заказ добавлен')
                return redirect('advertisement:advertisement_all')
    else:
        form = AdvertisementForm(initial={'author': request.user.pk})
        formset = AIFormSet()
    context = {'form': form, 'formset': formset}
    return render(request, 'advertisement/profile_advertisement_add.html', context)

После успешного добавления заказа появляется сообщение с выводом соответствующего всплывающего сообщения.


Контроллер-функция, реализующая просмотр всех заказов и откликов на них на странице заказчика:

def advertisement_client(request):
    advertisements = []
    total_responds = {}
    if request.user.is_client:
        advertisements = Advertisement.objects.filter(author=request.user.pk)
        for advertisement in advertisements:
            count = Respond.objects.filter(advertisement=advertisement.pk).count()
            total_responds[advertisement.pk] = count

    context = {
        'advertisements': advertisements,
        'total_responds': total_responds
    }
    print(context)
    return render(request, 'advertisement/advertisements_all.html', context)

Поле count - определяет количество откликнувшихся на заказы.  


Контроллер-функция, реализующая просмотр всех откликов на заказы:

def all_responds_view(request, pk):
    all_responds = Respond.objects.filter(advertisement=pk)
    context = {
            'all_responds': all_responds
        }
    return render(request, 'advertisement/all_responds.html', context)



Контроллер-функция, реализующая просмотр профиля откликнувшегося на заказ:

@login_required(login_url=reverse_lazy('account:login'))
@user_passes_test(lambda user:user.is_client)
def applicant_details_view(request, pk):
    respond = get_object_or_404(User, pk=pk)
    context = {
        'respond': respond
    }
    return render(request, 'advertisement/respond-details.html', context)

Контроллер-функция, реализующая просмотр каждого заказа заказчиком в своем профиле:

def single_advertisement_view(request, pk):
    advertisement = get_object_or_404(Advertisement, pk=pk)
    ais = advertisement.advertisementimage_set.all()

    context = {
        'advertisement': advertisement,
        'ais': ais,

    }
    return render(request, 'advertisement/advertisement_user_detail.html', context)


Контроллер-функция, реализующая удаление заказа:

def advertisement_delete(request, pk):
    adv=get_object_or_404(Advertisement, pk=pk)
    if request.method == 'POST':
        adv.delete()
        messages.add_message(request,messages.SUCCESS,'Заказ удален')
        return redirect('advertisement:advertisement_all')
    else:
        context={'adv':adv}
        return render(request,'advertisement/advertisement_delete.html', context)

После успешного удаление заказа появляется сообщение с выводом соответствующего всплывающего сообщения.




Контроллер-функция, реализующая редактирование заказа:

def advertisement_change(request,pk):
    adv=get_object_or_404(Advertisement,pk=pk)
    if request.method=='POST':
        form=AdvertisementForm(request.POST, request.FILES,instance=adv)
        if form.is_valid():
            adv=form.save()
            formset=AIFormSet(request.POST, request.FILES,instance=adv)
            if formset.is_valid():
                formset.save()
                messages.add_message(request,messages.SUCCESS,'Заказ обновлен')
                return redirect('advertisement:advertisement_all')
    else:
        form=AdvertisementForm(instance=adv)
        formset=AIFormSet(instance=adv)
    context={'form':form, 'formset': formset}
    return render(request,'advertisement/advertisement_change.html',context)

После успешного редактирования заказа появляется сообщение с выводом соответствующего всплывающего сообщения.


Контроллер-функция, реализующая отклик на заказ на основе ApplyForm :

def apply_advertisement_view(request, pk):
    rubric = get_object_or_404(Advertisement, pk=pk)
    form = ApplyForm(request.POST or None)
    user = get_object_or_404(User, pk=request.user.pk)
    respond = Respond.objects.filter(user=user, advertisement=pk)
    if not respond:
        if request.method == 'POST':
            if form.is_valid():
                instance = form.save(commit=False)
                instance.user = user
                instance.save()
                messages.success(
                    request, 'Вы успешно откликнулись на заказа!')
                return redirect(reverse('advertisement:rubric_detail', kwargs={'pk': pk,'rubric_pk': rubric.pk}))
        else:
            return redirect(reverse('advertisement:rubric_detail', kwargs={'pk': pk,'rubric_pk': rubric.pk}))
    else:
        messages.error(request, 'Вы уже откликнулись на заказ!')
        return redirect(reverse('advertisement:rubric_detail', kwargs={'pk': pk,'rubric_pk': rubric.pk }))

После успешного отклика на заказ появляется сообщение с выводом соответствующего всплывающего сообщения.



3.5 Django содержит большое количество встроенных тегов и фильтров. Иногда требуется  добавить собственный функционал к шаблонам. Для отображения всех откликнувшихся и проверки, откликнулся ли исполнитель на заказ, было создано два тэга 'get_total_respond' и 'is_advertisement_already_applied', позволяющие включать их в любую часть кода, путем добавления с помощью тега {% load %}. В этом же приложении была создана папка templatetags, в ней файлы get_total_responds.py, is_advertisement_already_applied.py и  __init__.py. __init__.py - это пустой файл, который сообщает python, что этот каталог следует рассматривать как пакет python. Тег 'get_total_respond’: 
      
from django import template

register = template.Library()


@register.simple_tag(name='get_total_respond')
def get_total_respond(total_responds, advertisement):
    return total_responds[advertisement.pk]

Тег is_advertisement_already_applied:

from django import template

from advertisement.models import Respond

register = template.Library()


@register.simple_tag(name='is_advertisement_already_applied')
def is_advertisement_already_applied(advertisement, user):
    applied = Respond.objects.filter(advertisement=advertisement, user=user)
    if applied:
        return True
    else:
        return False



3.6 Шаблоны представлений находятся в папке main/templates/main. Рассмотрим их подробнее: 



all_rubric.html-шаблон, выводящий все заказы в Надрубрике-Подрубрике:
{% extends "layout/base.html" %}
{% load static %}
{% load thumbnail %}
{% load bootstrap4 %}
{% block title %}{{ rubric }}{% endblock %}
{% block content %}
<div class="box-hidden2 text-center">
    <h4>{{ rubric}}</h4>
</div>
<div class="container-fluid mЬ-2">
    <div class="row">
        <div class="col">&nbsp;</div>
        <form class="col-md-auto form-inline">
            {% bootstrap_form form show_label=False %}
            {% bootstrap_button content='Искать' button_type='submit' %}
        </form>
    </div>
</div>
{% if adv %}
<ul class="list-unstyled">
    {% for a in adv %}
    <li class="media my-5 р-3 border">
        <div class="box-hidden2">
            <div class="media-body">
                {% url 'advertisement:rubric_detail' rubric_pk=rubric.pk pk=a.pk as url %}
                <h4 class="text-center"><a href="{{ url }}{{ all }}">Название: {{ a.title }}</a></h4>
                {% if a.image %}
                <div class="text-center">
                    <img class="mr-3" src="{% thumbnail a.image 'default' %}">
                </div>
                {% else %}
                {% endif %}
                <p class="text-right font-italic">Дата публикации: {{ a.data }} </p>
            </div>
        </div>
        <div class="box-hidden2">
            <p class="text-left">Описание: {{ a.description|linebreaks }} </p>
        </div>
    </li>
    {% endfor %}
</ul>
{% bootstrap_pagination page url=keyword %}
{% endif %}
{% endblock %}

Стилевой класс form-inline укажет веб-обозревателю вывести все элементы управления формы в одну строку. В самой форме мы не помещаем электронный жетон защиты, а для вывода кнопки применяем тег bootstrap.

{% bootst rap_pagination page url=keyword %} -базовый интернет-адрес берется из переменной keyword контекста шаблона, в которой хранится одноименный GЕТ-параметр с искомым словом. В результате при переходе на другую часть пагинатора контроллер получит это слово и выведет отфильтрованный по нему список объявлений.

rubric_detail.html-шаблон, выводящий детальную информацию по выбранному заказу:
{% extends "layout/base.html" %}
{% load is_advertisement_already_applied %}
{% load static %}
{% block title %}{{ advertisement.rubric.name }}-{{ advertisement.title }}{% endblock %}
{% block content %}
<div class="box-hidden2">
    <h4 class="text-center"> Название заказа: {{ advertisement.title }} </h4>
    <p class="text-left"> ОПИСАНИЕ: {{ advertisement.description|linebreaks }}</p>
    <p class="text-left">ПРИМЕРЫ: </p>
    <div class="row">
        <div class="col-lg-4 col-md-4 col-xs-4 thumb">
            {% if advertisement.image %}
            <a class="thumbnail" href="#">
                <p class="text-left">Основная иллюстрация: </p>
                <div class="col-md-auto"><img src="{{ advertisement.image.url }}" class="main-image"></div>
            </a>
            {% endif %}
        </div>
        <div class="col-lg-4 col-md-4 col-xs-4 thumb">
            {% if ais %}
            <a class="thumbnail" href="#">
                <p class="text">Дополнительные иллюстрации: </p>
                {% for ai in ais %}
                <img class="img-responsive" src="{{ ai.image.url }}" width="100">
            </a>
            {% endfor %} 
            {% endif %}
        </div>
    </div>
    <p class="text-right font-italic">Автор: {{ advertisement.author.username }} </p>
    <p class="text-right font-italic">Город: {{ advertisement.author.get_city_display }} </p>
    <p class="text-right font-italic">Дата публикации: {{ advertisement.data }} </p>
    <div class="text-right">
        {% if user.is_performer %}
        <a class="btn btn-success" href="{% url 'chat:create_dialog' advertisement.author.pk %}" role="button">Написать
            автору</a>
        {% endif %}
    </div>
    <h5 class="text-center"><a href= "{% url 'advertisement:all_rubric' pk=advertisement.rubric.pk %}{{ all }}">
        Назад</a></h5>
    {% if user.is_authenticated and user.is_performer %}
    {% is_advertisement_already_applied advertisement request.user as is_applied %}
    {% if is_applied %}
    <span  class="btn btn-danger btn-sm btn-block">Уже откликнулись</span>
    {% else %}
    <form action="{% url 'advertisement:apply-advertisement' advertisement.pk %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="advertisement" value="{{ advertisement.pk }}">
        <input type="submit" class="btn btn-success btn-sm btn-block" value="Откликнуться" />
    </form>
    {% endif %}
{% endif %}
</div>
<div class="box-hidden2">
    <div class="text-left">
        <h4> Новый комментарий</h4>
    </div>
    {% load crispy_forms_tags %}
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" value="Отправить" class="btn btn-primary" />
    </form>
    {% if comments %}
    {% for comment in comments %}
    <h5>{{ comment.author }}</h5>
    <h5>{{ comment.text }}</h5>
    <h5>{{ comment.date }}</h5>
    {% endfor %}
    {% endif %}
</div>
{% endblock %}

profile_advertisement_add.html-шаблон, выводящий страницу с формой добавления заказа:
{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block title %}Добавление заказа - Профиль пользователя{% endblock %}
{% block content %}
{% load crispy_forms_tags %}
<div class="box-hidden2">
    <h4 class="text-center">Добавление заказа</h4>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form|crispy }}
        {{ formset|crispy }}
        <button type="submit" class="btn btn-success">ДОБАВИТЬ</button>
    </form>
    {% endblock %}
</div>

advertisement_change.html-шаблон, выводящий страницу с формой редактирования заказа:
{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block title %}Редактирование заказа - Профиль пользователя{% endblock %}
{% block content %}
{% load crispy_forms_tags %}
<h4 class="text-center">Редактировать заказ</h4>
<div class="box-hidden2">
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %} 
        {{ form|crispy }} 
        {{ formset|crispy }}
        <button type="submit" class="btn btn-success">РЕДАКТИРОВАТЬ</button>
    </form>
</div>
{% endblock %}

advertisement_delete.html-шаблон удаления заказа:
{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block title %}Удаление заказа{% endblock %}
{% block content %}
{% load crispy_forms_tags %}
<div class="box-hidden2 text-center">
 <h4>Удалить заказ {{ adv.title }} ?</h4>
 <form method="post">
  <button type="submit" class="btn btn-danger">УДАЛИТЬ</button>
  {% csrf_token %}
 </form>
</div>
{% endblock %}

advertisements_all.html-шаблон, выводящий все заказы на станице Мои заказы:

{% extends "layout/base.html" %}
{% load get_total_respond %}
{% block content %}
<div class="box-hidden2">
    <div class="card">
        {% if user.is_client %}
        <h4 class="card-header text-center">Заказы пользователя {{ user.get_username }}</h4>
        {% if advertisements %}
        <table class="table text-center mt-5">
            <thead class="thead-light">
            <tr>
                <th>Название заказа</th>
                <th>Дата создания</th>
                <th>Отклики</th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            {% for advertisement in advertisements %}
            <tr>
                <td><a href="{% url 'advertisement:single-advertisement' advertisement.pk %}"><h5>{{ advertisement.title }}</h5></a></td>
                <td>{{ advertisement.data | date:'M d, Y'  }}</td>
                <td>
                    {% get_total_respond total_responds advertisement as is_respond %} 
                    {% if is_respond %}
                    <a href="{% url 'advertisement:responds' advertisement.pk %}">
                        <i class="fa fa-users"></i>
                        <div class="btn btn-outline-success btn-sm text-black">
                            {% if is_respond > 1 %} 
                            {% get_total_respond total_responds advertisement %} ОТКЛИКИ 
                            {% else %} 
                            {% get_total_respond total_responds advertisement %} ОТКЛИК 
                            {% endif %}
                        </div>
                    </a>
                    {% endif %}
                </td>
                <td>
                    <a class="btn btn-info btn-sm" href="{% url 'advertisement:profile_adv_change' pk=advertisement.pk %}"
                   role="button">РЕДАКТИРОВАТЬ</a>
                    <a class="btn btn-danger btn-sm" href="{% url 'advertisement:profile_adv_delete' pk=advertisement.pk %}"
                   role="button">УДАЛИТЬ</a>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="box-hidden2 text-center">
        <a class="btn btn-success btn-sm" href="{% url 'advertisement:profile_adv_add' %}" 
           role="button">ДОБАВИТЬ ЗАКАЗ</a>
    </div>
    {% else %}
    <div class="box-hidden text-center">
        <h4>У вас пока нет ни одного заказа. Добавьте его сейчас!</h4>
        <a class="btn btn-success btn-sm" href="{% url 'advertisement:profile_adv_add' %}"
           role="button">ДОБАВИТЬ ЗАКАЗ</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}

advertisement_user_detail.html-шаблон, выводящий каждый заказ в профиле заказчика:
{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block content %}
<div class="box-hidden2">
    <h4 class="text-center"> Название заказа: {{ advertisement.title }} </h4>
    <p class="text-left"> ОПИСАНИЕ: {{ advertisement.description|linebreaks }}</p>
    <p class="text-left">ПРИМЕРЫ: </p>
    <div class="row">
        <div class="col-lg-4 col-md-4 col-xs-4 thumb">
            {% if advertisement.image %}
            <a class="thumbnail" href="#">
                <p class="text-left">Основная иллюстрация: </p>
                <div class="col-md-auto"><img src="{{ advertisement.image.url }}" class="main-image"></div>
            </a>
            {% endif %}
        </div>
        {% if ais %}
        <a class="thumbnail" href="#">
            <p class="text">Дополнительные иллюстрации: </p>
            {% for ai in ais %}
            <img class="" src="{{ ai.image.url }}" width="200">
        </a>
        {% endfor %}
    </div>
    {% endif %}
</div>
<p class="text-right font-italic">Автор: {{ advertisement.author }} </p>
<p class="text-right font-italic">Город: {{ advertisement.author.get_city_display }} </p>
<p class="text-right font-italic">Дата публикации: {{ advertisement.data }} </p>
{% endblock %}

all_responds.html-шаблон, выводящий всех откликнувшихся исполнителей на заказ:
{% extends "layout/base.html" %}
{% load get_total_respond %}
{% load bootstrap4 %}
{% block content %}
<div class="box-hidden2">
    <h4 class="text-center"> Все отклики</h4>
</div>
<div class="box-hidden2">
    <section class="site-section">
        <div class="container">
            <div class="row">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Имя</th>
                            <th>Название заказа</th>
                            <th>Дата отклика</th>
                            <th>Детали </th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for respond in all_responds %}
                        {{ respond.get_total_respond }}
                        <tr>
                            <th scope="row">{{ respond.user.get_username }}</th>
                            <td>{{ respond.advertisement.title }}</td>
                            <td>{{ respond.advertisement.data }}</td>
                            <td><a href="{% url 'advertisement:respond-details' respond.user.pk %}">ПРОСМОТРЕТЬ</a></td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}

respond_details.html-шаблон, выводящий профиль откликнувшегося исполнителя:

{% extends "layout/base.html" %}
{% load bootstrap4 %}
{% block content %}
<div class="box-hidden2">
    <div class="box-hidden2">
        <div class="text-center text-sm-right">
            <span class="badge badge-success">исполнитель</span>
            <div class="text-right">
                <h4>Профиль пользователя {{ respond.get_username }}</h4>
            </div>
        </div>
        <div class="box-hidden2">
            <div class="row gutters-sm">
                <div class="col-md-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex flex-column align-items-center text-center">
                                {% if respond.avatar %}
                                <img src="{{ respond.avatar.url }}" alt="Avatar" class="avatar">
                                {% else %}
                                <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle" width="150">
                                {% endif %}
                                <div class="mt-3">
                                    <h4>{{ respond.get_username }}</h4>
                                    {% if respond.city %}
                                    <p class="text-secondary mb-1">{{ respond.get_city_display }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Полное имя</h6>
                                </div>
                                {% if respond.first_name or respond.last_name %}
                                <div class="col-sm-9 text-secondary">
                                    {{ respond.first_name }} {{ respond.last_name }}
                                </div>
                                {% else %}
                                <div class="col-sm-9 text-secondary">
                                    Нет имени
                                </div>
                                {% endif %}
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Телефон</h6>
                                </div>
                                {% if respond.phone_number %}
                                <div class="col-sm-9 text-secondary">
                                    {{ respond.phone_number }}
                                </div>
                                {% else %}
                                <div class="col-sm-9 text-secondary">
                                    Телефон не указан
                                </div>
                                {% endif %}
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    {% if respond.city %}
                                    <h6 class="mb-0">Город</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    {{ respond.get_city_display }}
                                </div>
                                {% else %}
                                <div class="col-sm-9 text-secondary">
                                    Город не указан
                                </div>
                                {% endif %}
                            </div>
                            <hr>
                            {% if respond.is_performer %}
                            <div class="row">
                                <div class="col-sm-3">
                                    {% if respond.performer.interests %}
                                    <h6 class="mb-0">Интересы</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    {{ respond.performer.interests }}
                                </div>
                                {% else %}
                                <div class="col-sm-9 text-secondary">
                                    Интересы не выбраны
                                </div>
                                {% endif %}
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Рубрика</h6>
                                </div>
                                {% if respond.performer.rubric %}
                                <div class="col-sm-9 text-secondary">
                                    {{ respond.performer.rubric }}
                                </div>
                                {% else %}
                                <div class="col-sm-9 text-secondary">
                                    Рубрика не выбрана
                                </div>
                                {% endif %}
                                {% endif %}
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Портфолио</h6>
                                </div>
                                {% if respond.performer.image %}
                                <img src="{{ respond.performer.image.url }}" class="main-image">
                                {% else %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a class="btn btn-success float-right" href="{% url 'chat:create_dialog' respond.pk %}" role="button">Написать сообщение</a>
</div>


      3.7   URL-адрес страниц определены в файле urls.py. Так же в этом файле представлено app_name- пространства имен приложений включенных URLconf_моделей. По этому имени возможно обращение из других приложений:

app_name = 'advertisement'
urlpatterns = [
    Выводим детальную информацию о выбранном заказе:
    path('<int:rubric_pk>/<int:pk>/', rubric_detail, name='rubric_detail'),
     Выводим все заказы:
    path('<int:pk>/',all_rubric,name='all_rubric'),
     Реализуем возможность откликнуться на выбранный заказа:
    path('apply-advertisement/<int:pk>/', views.apply_advertisement_view, name='apply-advertisement'),
    Выводим все объявления на странице заказчика:
    path('advertisements/', advertisement_client, name='advertisement_all'),
    Вывод детальную информацию по каждому заказу в профиле заказчика:
    path('advertisement/<int:pk>/', views.single_advertisement_view, name='single-advertisement'),
    Выводим всех откликнувшихся на заказы исполнителей:
    path('advertisements/<int:pk>/', views.all_responds_view, name='responds'),
    Выводим профиль откликнувшегося исполнителя:
    path('advertisement/respond/<int:pk>/', views.applicant_details_view, name='respond-details'),
    Выводим страницу удаления заказа:
    path('accounts/profile/delete_advertisement/<int:pk>/', advertisement_delete,name='profile_adv_delete'),
    Выводим страницу редактирования заказа:    path('accounts/profile/change_advertisement/<int:pk>/',advertisement_change,name='profile_adv_change'),
   Выводим страницу добавления заказа:
    path('accounts/profile/add_advertisement',advertisement_add,name='profile_adv_add'),
]
      3.8 Модели были зарегистрированы в панели администратора admin.py. 
class SubRubricInline(admin.TabularInline):
    model = SubRubric

class SuperRubricAdmin(admin.ModelAdmin):
    exclude = ('super_rubric',)
    inlines = (SubRubricInline,)
admin.site.register(SuperRubric, SuperRubricAdmin)

class SubRubricAdmin(admin.ModelAdmin):
    form = SubRubricForm
admin.site.register(SubRubric, SubRubricAdmin)

class AdvertisementImageInline(admin.TabularInline):
    model = AdvertisementImage

class AdvertisementAdmin(admin.ModelAdmin):
    list_display=('rubric','title','author','description','data')
    fields=(('rubric','author'),'title','description','image','is_active')
    inlines=(AdvertisementImageInline,)

admin.site.register(Advertisement,AdvertisementAdmin)
admin.site.register(Respond)

      3.9 Файл apps.py содержит следующий код:
      
class AdvertisementConfig(AppConfig):
    name = 'advertisement'
    verbose_name = 'Заказы'

AppConfig.name определяет полный путь python к приложению. 
AppConfig.verbose_name удобночитаемое название приложения: «Заказы»
      


4. Создание чата между пользователями
Для создания приложения Чат использовалась команда python manage.py startapp chat, которое находится внутри проекта mysite. Файловая структура показана на рис. 47:




Рис. 47 Файловая структура приложения Чат(chat)


      Файловая структура представляет собой:
      migrations: миграции -  отображает процесс преобразования моделей в БД
      static: располагаются подгружаемые css и js, а так же static-изображения в папке images, используемые на страницах.
      templates:  шаблон - это текстовый файл, определяющий структуру и разметку HTML страницы. Django будет автоматически искать шаблоны в каталоге с именем ' templates ' в приложении. Таким образом  render() функция ожидает найти файл .html  в / mysite / chat / templates / и выдаст ошибку, если файл отсутствует. Таким же образом будет найден шаблон для нового тэга, созданного по необходимости. Render() функция ожидает найти файл cakes_model.html  в / mysite / chat / templates / tags/ и выдаст ошибку, если файл отсутствует.
      templatetags: Django содержит большое количество встроенных тегов и фильтров. Иногда требуется  добавить собственный функционал к шаблонам. В этой папке хранятся созданные новые тэги.
      urls: определение URL-адреса страницы
      admin.py- регистрация моделей в панели администратора.
      view: представление - функция обработчика запросов. Получает HTTP-запросы и возвращает ответы. 
      models: модели Chat и Message представляют собой объект Python, которые определяет структуру данных приложения и предоставляет механизмы для управления (добавления, изменения, удаления) и выполнения запросов в базу данных.
      forms: HTML-формы для сбора пользовательских данных для обработки на сервере. 
      apps.py: объекты конфигурации приложения хранят метаданные для приложения в данном файле.
      


4.1 Создание моделей Чат и Сообщение.
Для создания страницы Чат создавались классы Chat и Message в models.py в приложении chat. 

class Chat(models.Model):
    DIALOG = 'D'
    CHAT_TYPE_CHOICES = (
        (DIALOG, _('Dialog')),
    )
    type = models.CharField('Тип',max_length=1,choices=CHAT_TYPE_CHOICES,default=DIALOG)
    members = models.ManyToManyField(User, verbose_name='Участник')

      Поле members класса Chat определяет отношение «многие ко многим» через ManyToManyField. 


    def get_absolute_url(self):
        return reverse('chat:messages', kwargs={'chat_id': self.pk})

      Метод get_absolute_url  используется для указания вычисления URL. Функция reverse реализует похожий на url тег шаблона, возвращает шаблон 'chat:messages' , отсортированный по словарю kwargs.


    class Meta:
        verbose_name='Чат'
        verbose_name_plural='Чаты'



class Message(models.Model):
    chat = models.ForeignKey(Chat, verbose_name='Чат', on_delete=models.CASCADE,default='')
    author = models.ForeignKey(User, verbose_name='Пользователь', on_delete=models.CASCADE,default='')
    message = models.TextField('Сообщение')
    pub_date = models.DateTimeField('Дата сообщения', default=timezone.now)
    is_readed = models.BooleanField('Прочитано', default=False)

      Поле chat класса Message определяет отношение «многие к одному» через ForeignKey к классу  Chat. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - Каскадное удаление. 
      Поле author класса Message определяет отношение «многие к одному» через ForeignKey к классу  User. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - Каскадное удаление. 


    class Meta:
        ordering = ['pub_date']

поле ordering сортирует по дате


Метод, возвращает строковое представление:
    def __str__(self):
        return self.message

    class Meta:
        verbose_name='Сообщение'
        verbose_name_plural = 'Сообщения'


4.2 В файле forms.py представлена форма MessageForm:

class MessageForm(ModelForm):
    class Meta:
        model = Message
        fields = ['message']
        labels = {'message': ""}


4.3 Для возврата собеседника в существующий диалог, был создан тэг 'get_companion’ В этом же приложении была создана папка templatetags, в ней файлы get_companion.py, и  __init__.py. __init__.py - это пустой файл, который сообщает python, что этот каталог следует рассматривать как пакет python. Тэг можно включить в  любой шаблон. Код тэга:

@register.simple_tag(name='get_companion')
def get_companion(user, chat):
    for u in chat.members.all():
        if u != user or user.is_performer:
            return u
        return None


4.4 В представлении vews.py прописана логика для вывода всех диалогов, всех сообщений в диалоге, а также написания сообщения и его отправка.

Вывод всех диалогов:

class DialogsView(View):
    def get(self, request):
        chats = Chat.objects.filter(members__in=[request.user.id])
        return render(request, 'chat/dialogs.html', {'user_profile': request.user, 'chats': chats})

Вывод всех сообщений в диалоге:
class MessagesView(View):
    def get(self, request, chat_id):
        try:
            chat = Chat.objects.get(id=chat_id)
            if request.user in chat.members.all():
                chat.message_set.filter(is_readed=False).exclude(author=request.user).update(is_readed=True)
            else:
                chat = None
        except Chat.DoesNotExist:
            chat = None

        return render(
            request,
            'chat/messages.html',
            {
                'user_profile': request.user,
                'chat': chat,
                'form': MessageForm()
            }
        )

    def post(self, request, chat_id):
        form = MessageForm(data=request.POST)
        if form.is_valid():
            message = form.save(commit=False)
            message.chat_id = chat_id
            message.author = request.user
            message.save()
        return redirect(reverse('chat:messages', kwargs={'chat_id': chat_id}))

Вывод нового сообщения:
class CreateDialogView(View):
    def get(self, request, user_id):
        chats = Chat.objects.filter(members__in=[request.user.id, user_id], type=Chat.DIALOG).annotate(c=Count('members')).filter(c=2)
        if chats.count() == 0:
            chat = Chat.objects.create()
            chat.members.add(request.user)
            chat.members.add(user_id)
        else:
            chat = chats.first()
        return redirect(reverse('chat:messages', kwargs={'chat_id': chat.id}))


4.5 Шаблоны:
dialog.html-вывод всех диалогов пользователя:
{% extends "layout/base.html" %}
{% block content %}
{% load get_companion %}
<div class="box-hidden2 text-left">
    <h4>Чаты</h4>
</div>
<div class="panel">
    {% if chats.count == 0 %}
    <p> Нет ни одного начатого диалога. </p>
</div>
{% endif %}
{% for chat in chats %}
{% if chat.message_set.count != 0 %}
{% with last_message=chat.message_set.last %}
{% get_companion user chat as companion %}
<a class="list-group-item {% if companion == last_message.author %}unreaded{% endif %}" 
   href="{{ chat.get_absolute_url }}">
    {% if companion.avatar %}
    <img class="avatar-image" src="{{ companion.avatar.url }}" align="left">
    {% else %}
    <img class="avatar-image" src="" align="left">
    {% endif %}
    <div class="reply-body">
        <ul class="list-inline">
            <li class="drop-left-padding">
                <strong class="list-group-item-heading">{{ companion.username }}</strong>
            </li>
            <li class="pull-right text-muted"><small>{{ last_message.pub_date }}</small></li>
        </ul>
        {% if companion != last_message.author %}
        <div>
            <img class="avatar-image" src="{{ last_message.author.avatar.url }}">
            {{ last_message.author.username }}
            <div class="attached-reply-body {% if not last_message.is_readed %}unreaded{% endif %}">
                {{ last_message.message|truncatechars_html:"200"|safe|striptags }}</div>
        </div>
        {% else %}
        <div>{{ last_message.message|truncatechars_html:"200"|safe|striptags }}</div>
        {% endif %}
    </div>
</a>
{% endwith %}
{% endif %}
{% endfor %}
{% endblock %}

{% load get_companion %} подгружаем тег. {% if chats.count == 0 %}-проверяем, есть ли созданные чаты у пользователя. Если нет, выводим сообщение что их нет. Если есть-выводим последние чаты и проверяем чье было последнее сообщение.


messages.html-вывод всех сообщений в диалоге:
{% extends "layout/base.html" %}
{% block content %}
{% load get_companion %}
{% if not chat %}
<div class="panel panel-body">
    Невозможно начать беседу. Не найден пользователь или вы не имеете доступа к данной беседе
</div>
{% else %}
{% load tz %}
{% if chat %}
<div id="messages" class="panel">
    <div id="innerMessages">
        {% for message in chat.message_set.all %} 
        {% include 'chat/message.html' with message_item=message %} 
        {% endfor %}
    </div>
</div>
{% endif %}
<div class="box-hidden2">
    <div id="message_form">
        <form id="message-form" class="panel panel-body" method="post" >
            {% load bootstrap4 %}
            {% csrf_token %}
            {% bootstrap_form form %}
            <button type="submit" class="btn btn-success btn-sm" onclick="return ETextEditor.validateForm('message-form')"><span class="ico ico-comment"></span> ОТПРАВИТЬ </button>
        </form>
    </div>
{% endif %}
</div>
{% endblock %}

{% for message in chat.message_set.all %}- с помощью цикла выводим все сообщения в диалоге. {% bootstrap_form form %}-выводим форму отправки сообщения

message.html-форма сообщений:
{% url 'users:profile' message_item.author.username as the_user_url %}
<div class="box-hidden2">
    <div class="list-group-item {% if not message_item.is_readed %}unreaded{% endif %}">
        <a href="{{ the_user_url }}"><img class="avatar-image" src="{{ message_item.author.avatar.url }}" align="left"></a>
        <div class="reply-body">
            <ul class="list-inline">
                <li class="drop-left-padding">
                    <strong class="list-group-item-heading"><a href="{{ the_user_url }}">{{ message_item.author.username }}</a></strong>
                </li>
                <li class="pull-right text-muted"><small>{{ message_item.pub_date }}</small></li>
            </ul>
            <div>{{ message_item.message|safe }}</div>
        </div>
    </div>
</div>

      4.6 URL-адрес страниц определены в файле urls.py. Так же в этом файле представлено app_name- пространства имен приложений включенных URLconf_моделей. По этому имени возможно обращение из других приложений:

app_name = 'chat'
urlpatterns = [
Вывод всех диалогов пользователя:
path('dialogs/', login_required(views.DialogsView.as_view()), name='dialogs'),
Вывод всех сообщений в диалоге пользователя:
path('dialogs/<int:chat_id>/', login_required(views.MessagesView.as_view()), name='messages'),
Вывод формы сообщения:
path('dialogs/create/<int:user_id>/', login_required(views.CreateDialogView.as_view()), name='create_dialog'), ]

      4.7 Файл apps.py содержит следующий код:

class ChatConfig(AppConfig):
    name = 'chat'
    verbose_name = 'Сообщения'

      4.8 Модели были зарегестрированы в панели администратора admin.py. 

admin.site.register(Chat)
admin.site.register(Message)



5. Создание Комментариев к заказу

	Для создания приложения Комментарии использовалась команда python manage.py startapp comments, которое находится внутри проекта mysite. Файловая структура показана на рис. 48:




Рис. 48 Файловая структура приложения Комментарии (comments)


      Файловая структура представляет собой:
      migrations: миграции -  отображает процесс преобразования моделей в БД
      templates:  шаблон - это текстовый файл, определяющий структуру и разметку HTML страницы. Django будет автоматически искать шаблоны в каталоге с именем ' templates ' в приложении. Таким образом  render() функция ожидает найти файл  .html  в / mysite / comments / templates / и выдаст ошибку, если файл отсутствует.
      urls: определение URL-адреса страницы
      admin.py- регистрация моделей в панели администратора.
      view: представление - функция обработчика запросов. Получает HTTP-запросы и возвращает ответы. 
      models: модель Comments  представляет собой объект Python, который определяет структуру данных приложения и предоставляет механизмы для управления (добавления, изменения, удаления) и выполнения запросов в базу данных.
      forms: HTML-формы для сбора пользовательских данных для обработки на сервере. 
      apps.py: объекты конфигурации приложения хранят метаданные для приложения в данном файле.

5.1  Создание модели Комментария. Для создания комментариев к заказам создавался class Comments в models.py в приложении comments:

class Comments(models.Model):
    advertisement=models.ForeignKey(Advertisement,on_delete=models.CASCADE,verbose_name='Объявления')
    author=models.CharField(max_length=40,verbose_name='Автор')
    text=models.TextField(verbose_name='Содержание')
    is_active=models.BooleanField(default=True, db_index=True,verbose_name='Активен?')
    date=models.DateTimeField(auto_now_add=True,db_index=True,verbose_name='Дата публикации')

	Поле advertisement класса определяет отношение «многие к одному» через ForeignKey  к классу  Advertisement, т.к. у заказа может быть несколько комментариев. on_delete- определяет то, как должна работать связь, в данном случае: models. CASCADE - каскадное удаление

Метакласс:
    class Meta:
        verbose_name='Комментарий'
        verbose_name_plural='Комментарии'
        ordering=['date']

В модели были объявлены метаданные уровня модели, которые возвращали удобночитаемое название класса.

5.2 Создание формы комментария в forms.py:


class UserCommentForm(forms.ModelForm):
    class Meta:
        model = Comments
        exclude = ('is_active',)
        widgets = {'advertisement': forms.HiddenInput}

поле widgets = {'advertisement': forms.HiddenInput}-скрывает название заказа 

      5.3  Модель была зарегистрирована в панели администратора. Файл admin.py:
      
admin.site.register(Comments)

      5.4 Файл apps.py содержит следующий код:

class CommentsConfig(AppConfig):
    name = 'comments'
    verbose_name = 'Комментарии'

AppConfig.name определяет полный путь python к приложению. 
AppConfig.verbose_name удобночитаемое название приложения: «Комментарии»
      
5.5 Форму комментариев добавляем в функцию rubric_detail, которая выводит детальное отображение каждого заказа в приложении advertisement файле views.py

def rubric_detail(request, rubric_pk, pk):
    global form_class
    advertisement=get_object_or_404(Advertisement, pk=pk)
    ais = advertisement.advertisementimage_set.all()
    comments = Comments.objects.filter(advertisement=pk,is_active=True)
    initial={'advertisement': advertisement.pk}
    if request.user.is_authenticated:
        initial['author']=request.user.username
        form_class = UserCommentForm
    else:
        form_class = UserCommentForm
        messages.error(request, 'Войдите чтобы написать комментарий.')
    form = form_class(initial=initial)
    if request.method == 'POST':
        c_form = form_class(request.POST)
        if c_form.is_valid():
            c_form.save()
            messages.add_message(request,messages.SUCCESS,'Комментарий добавлен')
        else:
            form =UserCommentForm
            messages.add_message(request,messages.WARNING,'Комментарий не добавлен')
    context = {'advertisement':advertisement,'ais':ais,'comments':comments,'form': form}
    return render(request, 'advertisement/rubric_detail.html', context)

Строка initial['author']=request.user.username- означает получение имени вошедшего в систему пользователя автоматически в поле 'author' модели Comments.

После успешного написания комментария появляется сообщение с выводом соответствующего всплывающего сообщения. Для незарегистрированных пользователей
есть возможность просматривать комментарии, но не писать их.


5.6 Форма комментария и вывод всех комментариев представлен в шаблоне rubric_detai.html приложения advertisement. Ниже представлен код формы комментария и вывод списка комментариев к заказу:

<div class="text-left">
        <h4> Новый комментарий</h4>
    </div>
    {% load crispy_forms_tags %}
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" value="Отправить" class="btn btn-primary" />
    </form>
    {% if comments %}
    {% for comment in comments %}
    <h5>{{ comment.author }}</h5>
    <h5>{{ comment.text }}</h5>
    <h5>{{ comment.date }}</h5>
    {% endfor %}
    {% endif %}
</div>










6 Функциональное тестирование решения
Тест 1. Тестирование страницы Главная.

Идентификатор тест-варианта1Набор входных данныхОтображение главной страницы ORDER.MEОжидаемые результатыОтображение страницы Главная с главным меню и футером (рис. 49)Выполняемые действия1. Загрузить локальный сервер.
2. Нажать на ссылку Главная страница


Рис. 49 Отображение Главной страницы.


Тест 2. Тестирование страницы Все исполнители для незарегистрирвоанных пользователей.


Идентификатор тест-варианта2Набор входных данных-Ожидаемые результатыОтображение страницы входа(рис. 50)Выполняемые действия1. Загрузить локальный сервер.
2. Нажать на ссылку Все исполнители





Рис. 50 Отображение страницы входа, если гость нажмет на ссылку Все исполнители.

Тест 3. Тестирование страницы для регистрации заказчика.


Идентификатор тест-варианта3Набор входных данныхНажатие на ссылку : зарегистрироваться в качестве заказчикаОжидаемые результатыОтображение страницы с формой регистрацией заказчика (рис. 51)Выполняемые действия1. Загрузить локальный сервер.
2. Нажать на регистрацию заказчика в приветствии



Рис. 51 Отображение формы регистрации заказчика








Тест 4. Тестирование страницы регистрации для заказчиков.

Идентификатор тест-варианта4Набор входных данныхВведение в форму регистрации следующих параметров:
Имя пользователя: Alena
Пароль: muse2313
Подтверждение пароля: muse2313
Город: Москва
Ожидаемые результаты1.Получение результатов в БД (рис. 52):
2.Отображение профиля заказчика после регистрации (рис. 53):
Выполняемые действия1.Перейти по ссылке регистрации как заказчик.
2. Ввести данные в форму
3. Нажать кнопку Зарегистрироваться







Рис. 52 Получение результатов в БД


Рис. 53 Отображение профиля заказчика после регистрации






Тест 5. Тестирование страницы Изменить личные данные(заказчик).

Идентификатор тест-варианта5Набор входных данныхВведение в форму изменения следующих данных (рис. 54):
Имя: Алена
Фамилия: Иванова
Город: Челябинск
Телефон:-
Аватар: Portman.jpgОжидаемые результаты1. Отображение обновленных данных на странице Мой профиль (рис. 55 )
2. Получение в БД следующих данных (рис. 56 ):
Имя: Алена
Фамилия: Иванова
Город: Челябинск
Телефон:-
Аватар: Portman.jpgВыполняемые действия1. Нажать на кнопку Изменить личные данные на странице Мой профиль
2. Ввести в форму данные
3. Нажать кнопку Редактировать

Рис. 54 Введение в форму личных данных



Рис. 55 Отображение профиля с новыми данными



Рис. 56 Получение новых данных в БД


Тест 6. Тестирование страницы Изменить пароль(заказчик).

Идентификатор тест-варианта6Набор входных данных1. Нажатие на кнопку “Изменить пароль”
2. Введение в форму изменения следующих данных (рис. 57 ):
Старый пароль: muse2313
Новый пароль:muse1323
Подтверждение нового пароля:muse1323Ожидаемые результаты1. Отображение обновленных данных на странице Мой профиль (рис. 58)
Выполняемые действия1. Нажать на кнопку “Изменить личные данные” на странице Мой профиль
2. Ввести в форму данные
3. Нажать кнопку “Редактировать”





Рис. 57 Введение в форму нового пароля


Рис. 58 Отображение профиля с новыми данными


Тест 7. Тестирование страницы Выход (заказчик).

Идентификатор тест-варианта7Набор входных данныхНетОжидаемые результаты1. Выход из профиля
2. Переход на страницу с сообщением об успешном выходе из профиля (рис. 59)Выполняемые действия1. Нажать на ссылку Выход




Рис. 59 Отображение страницы выхода.




Тест 8. Тестирование Входа для зарегистрированного пользователя (заказчик).

Идентификатор тест-варианта8Набор входных данныхИмя пользователя: Alena
Пароль: muse1323Ожидаемые результаты1. Вход в систему (рис. 60 )Выполняемые действия1. Нажать на ссылку Вход
2. Ввести в форму данные зарегистрированного пользователя (рис. 61 )




Рис. 60 Отображение профиля при успешном входе.




Рис. 61 Отображение страницы входа.







Тест 9. Тестирование страницы Мои заказы (заказчик).

Идентификатор тест-варианта9Набор входных данных-
Ожидаемые результаты1. Отображение списка заказов, если они существуют, кнопка “Добавить заказ”
2. Отображение предупреждения об отсутствии заказов, кнопка “Добавить заказ”(рис. 62)
Выполняемые действия1. Нажать на ссылку Мои заказы






Рис. 62 Отображение отсутствия заказов и кнопка Добавить заказ




Тест 10. Тестирование страницы Добавить заказ (заказчик).

Идентификатор тест-варианта10Набор входных данныхВведение в форму заказа следующих данных:
Рубрика: Вязание-Куклы
Название заказа: Кукла
Описание заказа: Ребенок нарисовал куклу. Хочу, чтобы у нас была такая же мягкая игрушка. Цвета и размер можно обсудить.
Прикрепить изображение: Игрушка.jpg
Дополнительная иллюстрация:-Ожидаемые результаты1. Получение уведомления об успешном добавлении заказа
2. Отображение списка заказов на странице Мои заказы (рис. 63)
3. Получение результатов в БД (рис. 64)Выполняемые действия1. Нажатие на кнопку “Добавить заказ”
2. Заполнить форму (рис. 65 )
3. Нажать на кнопку “Добавить”





Рис. 63 Отображение заказа в списке заказов заказчика







Рис. 64 Получение результатов в БД


Рис. 65 Заполнение формы заказа


Тест 11. Тестирование страницы Редактировать заказ (заказчик).

Идентификатор тест-варианта11Набор входных данныхВведение в форму редактирования заказа следующих данных:
Рубрика: Вязание-Куклы
Название заказа: Кукла
Описание заказа: Ребенок нарисовал куклу. Хочу, чтобы у нас была такая же мягкая игрушка. Размер должен быть полметра. Юбка дожна быть внизу с воланом. Фото волана прилагаю.
Прикрепить изображение: Игрушка.jpg
Дополнительная иллюстрация: Volan.jpgОжидаемые результаты1. Получение уведомления об успешном редактировании заказа (рис. 66 )
2. Получение результатов в БД (рис. 67)Выполняемые действия1. Нажать на ссылку Мои заказы
2. Нажатие на кнопку “Редактировать” рядом с выбранным объявлением
3. Редактировать данные в форме (рис. 68)
4. Нажать на кнопку “Редактировать”










Рис. 66 Получение уведомления об успешном редактировании заказа



Рис. 67 Получение обновленных результатов в БД




Рис. 68 Редактирование формы заказа


Тест 12. Просмотр заказа заказчиком на странице Мои заказы(заказчик).

Идентификатор тест-варианта12Набор входных данных-Ожидаемые результаты1. Получение детальной информации по выбранному заказу (рис. 69)
Выполняемые действия1. Нажать на ссылку Мои заказы
2. Нажать на название заказа 



Рис. 69 Просмотр детальной информации по заказу заказчиком в личном профиле.

Тест 13. Тестирование страницы Удалить заказ (заказчик).

Идентификатор тест-варианта13Набор входных данных-Ожидаемые результаты1. Получение уведомления об успешном удалении заказа
2. Удаление из БД (рис. 72)Выполняемые действия1. Войти в профиль заказчика
2. Нажать на ссылку Мои заказы (рис. 70)
3. Нажатие на кнопку “Удалить” рядом с заказом Рюкзак
4. Посмотреть удаление со странице Все заказы (рис. 71)



Рис. 70 Просмотр всех заказов заказчика.




Рис. 71 Просмотр удаления со страницы Мои заказы.


Рис. 72 Удаление из БД.


Тест 14. Тестирование страницы Мои сообщения.

Идентификатор тест-варианта14Набор входных данных-Ожидаемые результаты1. Вывод списка всех диалогов
2. Уведомление об отсутствии диалогов, если их нет (рис. 73)Выполняемые действия1. Нажать на ссылку Мои сообщения


Рис. 73 Страница Мои сообщения у заказчика.


Тест 15. Тестирование страницы Удалить профиль (заказчик).

Идентификатор тест-варианта15Набор входных данныхПользователь Elena (рис. 74 )Ожидаемые результаты1. Удаление пользователя
2. Получение сообщения об удалении пользователя и переход на гланую страницу (рис. 75)
3. Удаление из БД (рис. 76)Выполняемые действия1. Войти в профиль Elena
2. Нажать на ссылку Удалить профиль
3. Переход на страницу Удалить профиль пользователя с кнопкой “Удалить”






Рис. 74 Заказчик Elena в БД.





Рис. 75 Получение сообщения об удалении заказчика и переход на главную страницу.






Рис. 76 Удаление Elena из БД.


Тест 16. Тестирование страницы Надрубрики-Подрубрики (заказчик)

Идентификатор тест-варианта16Набор входных данных- Ожидаемые результаты1. Отображение заказа в разделе Надрубрика-Подрубрика (рис. 77)Выполняемые действия1. Нажать на выбранную подрубрику (Куклы) в разделе рубрик (Вязание)

Рис. 77 Просмотр заказа в разделе Надрубрика-Подрубрика.




Тест 17. Тестирование детального отображения заказа в разделе Надрубрика-Подрубрика (заказчик).



Идентификатор тест-варианта17Набор входных данных-Ожидаемые результаты1. Детальное отображение выбранного заказа (рис. 78)Выполняемые действия1. Нажать на выбранные заказ в разделе Надрубрика-Подрубрика




Рис. 78 Просмотр детальной информации о заказе в разделе Надрубрика-Подрубрика.




Тест 18. Тестирование страницы детального отображения заказа в разделе Надрубрика-Подрубрика. Оставление комментария заказчиком

Идентификатор тест-варианта18Набор входных данныхВвести данные в форму (рис. 79): 
Автор: Alena(автоматически)
Содержание: Стоимость не дороже 2000р. Сроки можно обсудить.Ожидаемые результаты1. Отображение отправленного комментария под описанием заказа (рис. 80 )
2. Получение результатов в БД (рис. 81)Выполняемые действия1. Ввести данные в форму 
2. Нажать кнопку “Отправить”




Рис. 79 Введение комментария в форму.



Рис. 80 Отображение отправленного комментария под заказом.



Рис. 81 Получение результатов в БД.


Тест 19. Тестирование страницы всех исполнителей. Тестирование фильтра(оба вида пользователей). 

Идентификатор тест-варианта19Набор входных данныхИсполнители:
Юля-Санкт-Петербург
Инна-Москва
Анна-Челябинск
Марина-МоскваОжидаемые результаты1. Отображение списка всех исполнителей (рис. 82)
2. Отображение исполнителей по выбранному городу (Москва)(рис. 83 )Выполняемые действия1. Нажать на страницу Все исполнители
2. Выбрать город Москва в фильтре






Рис. 82 Отображение списком всех исполнителей.



Рис. 83 Отображение списка исполнителей после филтрации г. Москва.








Тест 20. Тестирование страницы детального отображения профиля исполнителя в списке исполнителей(исполнитель). 

Идентификатор тест-варианта20Набор входных данных-Ожидаемые результаты1. Отображение профиля выбранного исполнителя (рис. 84 )Выполняемые действия1. Нажать на выбранного исполнителя в списке всех исполнителей 



Рис. 84 Профиль выбранного исполнителя.

Тест 21. Тестирование страницы детального отображения профиля исполнителя в списке исполнителей(заказчик). 

Идентификатор тест-варианта21Набор входных данных-Ожидаемые результаты1. Отображение профиля выбранного исполнителя (рис. 85 )Выполняемые действия1. Нажать на выбранного исполнителя в списке всех исполнителей 



Рис. 85 Профиль выбранного исполнителя.




Тест 22. Тестирование страницы детального отображения профиля исполнителя в списке исполнителей. Отправка сообщения. 

Идентификатор тест-варианта22Набор входных данныхТекст сообщения от Alena к Marina:
Привет! Мне нужно сшить платье. Возмешься?Ожидаемые результаты1. Отображение сообщения в профиле заказчика (рис. 86)
1. Отображение сообщения в профиле исполнителя (рис. 87 )
3. Получение в БД (рис. 88)Выполняемые действия1. Нажать на выбранного исполнителя в списке всех исполнителей 
2. Нажать “Написать сообщение”
3. Ввести данные
4. Нажать “Отправить”

Рис. 86 Отображение сообщения у Alena -заказчик.







Рис. 87 Отображение сообщения у Marina -исполнитель.





Рис. 88 Отображение сообщения в БД.


Тест 23. Тестирование страницы регистрации для исполнителей.

Идентификатор тест-варианта23Набор входных данных1. Введение в форму регистрации следующих параметров (рис. 89):
Имя пользователя: Inna
Пароль: muse2313
Подтверждение пароля: muse2313
Опишите свои интересы: вязание
Город: Санкт-Петербург
Ожидаемые результаты1. Получение результатов в БД (рис. 90):
2. Переход на страницу профиля (рис. 91)Выполняемые действия1.Перейти по ссылке регистрации как исполнитель.
2. Ввести данные в форму
3. Нажать кнопку Зарегистрироваться









Рис. 89 Форма регистрации с параметрами.





Рис. 90 Получение результатов в БД.




Рис. 91 Переход на страницу профиля

Тест 24. Тестирование страницы Мой профиль(исполнитель).

Идентификатор тест-варианта24Набор входных данных-Ожидаемые результатыОтображение страницы Мой профиль
(рис. 92 )Выполняемые действия1. Нажать на ссылку Мой профиль в меню профиля






Рис. 92 Отображение страницы профиля.

Тест 25. Тестирование страницы Изменить личные данные (исполнитель).

Идентификатор тест-варианта25Набор входных данныхВведение в форму изменения следующих данных (рис. 93):
Имя: Инна
Фамилия: Иванова
Город: Москва
Телефон: 8986345985
Интересы: вязание и шитье
Рубрика: вязание
Портфолио: Вязаная игрушка.jpg
Аватар: Teron.jpgОжидаемые результаты1. Отображение обновленных данных на странице Мой профиль (рис. 94)
2. Получение в БД входных данных (рис. 95):
Выполняемые действия1. Нажать на кнопку “Изменить личные данные” на странице Мой профиль
2. Ввести в форму данные
3. Нажать кнопку “Редактировать”



Рис. 93 Форма редактирования.



Рис. 94 Отображение измененного профиля.







Рис. 95 Получение результатов в БД.




Тест 26. Тестирование страницы Изменить пароль(исполнитель).

Идентификатор тест-варианта26Набор входных данныхВведение в форму изменения следующих данных (рис. 96):
Старый пароль: muse2313
Новый пароль: muse1323
Подтверждение нового пароля:muse1323Ожидаемые результаты1. Изменение пароля пользователя
Выполняемые действия1. Нажать на кнопку “Изменить пароль” на странице Мой профиль
2. Ввести в форму данные
3. Нажать кнопку “Изменить”


Рис. 96 Форма редактирования.


Тест 27. Тестирование страницы Мои сообщения (исполнитель).

Идентификатор тест-варианта27Набор входных данных-Ожидаемые результаты1. Вывод списка всех диалогов
2. Уведомление об отсутствии диалогов, если их нет (рис. 97)Выполняемые действия1. Нажать на ссылку Мои сообщения

Рис. 97 Страница Мои сообщения у исполнителя.

Тест 28. Тестирование страницы Выход (исполнитель).

Идентификатор тест-варианта28Набор входных данных-Ожидаемые результаты1. Выход из профиля
2. Переход на страницу с сообщением об успешном выходе из профиля (рис. 98)Выполняемые действия1. Нажать на ссылку Выход

Рис. 98 Отображение страницы выхода.



Тест 29. Тестирование страницы Удалить профиль (исполнитель).

Идентификатор тест-варианта29Набор входных данныхИсполнитель Ivan (рис. 99 )Ожидаемые результаты1. Удаление пользователя
2. Удаление из БД (рис. 100 )Выполняемые действия1. Войти в профиль пользователя Ivan
2. Нажать на ссылку Удалить профиль
3. Переход на страницу Удалить профиль пользователя с кнопкой “Удалить”

Рис. 99 Исполнитель Ivan в БД.




Рис. 100 Удаление из БД.

Тест 30. Тестирование Входа для зарегистрированного пользователя (исполнитель).

Идентификатор тест-варианта30Набор входных данныхИмя пользователя: Inna
Пароль: muse1323Ожидаемые результаты1. Вход в систему с отбражением профиля(рис. 101)Выполняемые действия1. Нажать на ссылку Вход
2. Ввести в форму данные зарегистрированного пользователя (рис. 102):





Рис. 101 Отображение профиля исполнителя после входа.





Рис. 102 Отображение формы входа с введенными данными.


Тест 31. Тестирование страницы Надрубрика-подрубрика (исполнитель).

Идентификатор тест-варианта31Набор входных данных-Ожидаемые результаты1. Отображение списка заказов (рис. 103)Выполняемые действия1. Нажать на выбранную подрубрику(Куклы) в разделе рубрик(Вязание)


Рис. 103 Отображение списка заказов


Тест 32. Тестирование страницы детального отображения заказа в разделе Надрубрика-Подрубрика. Оставление отклика исполнителем


Идентификатор тест-варианта32Набор входных данных-Ожидаемые результаты1. Детальное отображение выбранного заказа (рис. 104)Выполняемые действия1. Нажать на выбранные заказ в разделе Надрубрика-Подрубрика




Рис. 104 Детальное отображение выбранного заказа.



Тест 33. Тестирование страницы Заказа. Оставление отклика (исполнитель).

Идентификатор тест-варианта33Набор входных данных-Ожидаемые результаты1. Изменение цвета и надписи кнопки “Откликнуться” на “Уже откликнулись” при отклике на заказ
(рис. 105)
2. Получение отклика в БД (рис. 106)
3. Отображение отклика в списке заказов у заказчика (рис. 107)
Выполняемые действия1. Нажать на кнопку “Откликнуться” у выбранного заказа







Рис. 105 Изменение цвета кнопки после отклика исполнителя



Рис. 106 Получение отклика в БД



Рис. 107 Получение отклика в списке заказов у заказчика.


Тест 34. Тестирование страницы Заказа. Отправка сообщения заказчику.

Идентификатор тест-варианта34Набор входных данныхСообщение:
Привет! За 1500 р. Готова сделатьОжидаемые результаты1. Отображение сообщения у заказчика (рис. 108) и исполнителя (рис. 109)
2. Отображение в списке чатов(рис. 110)
2. Получение результатов в БД (рис. 111)
Выполняемые действия1. Нажать на кнопку “Написать” у выбранного заказа и ввести входные данные


Рис. 108 Отображение сообщения у исполнителя.


Рис. 109 Отображение сообщения у заказчика.






Рис. 110 Отображение в списке чатов у исполнителя.


Рис. 111 Отображение в БД.

Тест 35. Тестирование страницы Мои заказы (заказчик). Отображение отклика исполнителя.

Идентификатор тест-варианта35Набор входных данных-Ожидаемые результаты1. Получение количества откликов у заказа
Выполняемые действия1. Войти в систему как заказчик, на заказ которого был отклик
2. Перейти по меню профиля на ссылку Мои заказы
3. Увидеть количество откликов на заказ (рис. 112)



Рис. 112 Отображение отклика исполнителя на заказ на странице Мои заказы
Тест 36. Тестирование страницы откликов на заказ. Вывод всех откликнувшихся (заказчик).


Идентификатор тест-варианта36Набор входных данных-Ожидаемые результаты1. Вывод список всех откликнувшихся на заказ (рис. 113)
Выполняемые действия1. Нажать на кнопку откликов возле заказа 



Рис. 113 Получение списка откликнувшихся на заказ исполнителей.


Тест 37. Тестирование профиля откликнувшегося исполнителя

Идентификатор тест-варианта37Набор входных данных-Ожидаемые результаты1. Переход на профиль откликнувшегося исполнителя (рис. 114 )
Выполняемые действия1. Нажать на кнопку ссылку ПРОСМОТРЕТЬ в столбце Детали страницы Все отклики


Рис. 114 Отображение профиля откликнувшегося исполнителя.

Тест 38. Написание сообщения откликнувшемуся исполнителю

Идентификатор тест-варианта38Набор входных данныхСообщение:
Привет! ДоговорилисьОжидаемые результаты1. Вывод страницы с формой сообщения и кнопкой “Отправить” 
2. Отображение отправленного сообщения у заказчика (рис. 115) и у исполнителя (рис. 116 )
3. Получение результатов в БД (рис. 117)Выполняемые действия1. Перейти по ссылке на профиль откликнувшегося исполнителя 
2. Нажать кнопку “Написать сообщение”
3. Ввести текст сообщения
4. Нажать на кнопку “Отправить”




Рис. 115 Отображение сообщения у заказчика.





Рис. 116 Отображение сообщения у исполнителя.



Рис. 117 Получение результата в БД.

Тест 38. Тестирование страницы детального отображения заказа в разделе Надрубрика-Подрубрика. Оставление комментария исполнителем

Идентификатор тест-варианта39Набор входных данныхВвести данные в форму: 
Автор: Inna(автоматически)
Содержание: Через месяц могу сделать эту работу.Ожидаемые результаты1. Отображение отправленного комментария под описанием заказа (рис.120 )
2. Получение результатов в БД (рис. 121)Выполняемые действия1. Ввести данные в форму (рис. 119 ) 
2. Нажать кнопку “Отправить”





Рис. 119 Введение данных в форму комментария.




Рис. 120 Публикация комментария.


Рис. 121 Получение результатов в БД.


Тест 40. Тестирование страницы Надрубрика-Подрубрика. Поиск по заказам

Идентификатор тест-варианта40Набор входных данных“ кукл“Ожидаемые результаты1. Отображение правильного заказа по введенному слову (рис. 122 )Выполняемые действия1. Выбрать Надрубрику-Подрубрику: Вязание-куклы (рис. 123 )
2. Ввести в поисковую строку ‘кукл’

Рис. 122 Все заказы.



Рис. 123 Результаты поиска.

Список литературы

1. https://developer.mozilla.org/ru/docs/Learn/Server-side/Django/development_environment

2. Дронов В. Django 3.0 Практика создания веб-сайтов на Python/ Дронов В.-Санкт-Петербург: БХВ-Петербург, 2021- 704с.
3.  https://docs.djangoproject.com/

4. https://www.youtube.com/watch?v=FZAO72uTj0M

5. https://simpleisbetterthancomplex.com/

6.  http://impactmapping.org

7. Дин Лэффингуэлл, Дон Уидриг  Принципы работы с требованиями к программному обеспечению. Унифицированный подход / Дин Лэффингуэлл, Дон Уидриг-Вильямс , 448 с.
8. ГОСТ 34.602-89 Техническое задание на создание автоматизированной системы: [утвержден и введен в действие Постановлением Государственного комитета СССР по стандартам от 24.03.89 N 661]-  Дата введения 1990-01-01
9. https://stackoverflow.com/
10. https://habrahabr.ru/post/138749/
11. https://habrahabr.ru/post/140574/

12. http://blog.byndyu.ru/2014/12/impact-mapping.html

13. http://www.cossa.ru/149/101189/

14. Построение карт историй - Story Mapping


2



49





146



